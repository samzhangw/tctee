<!DOCTYPE html>
<html lang="zh-TW">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
    <meta name="theme-color" content="#4361ee" />
    <meta name="description" content="115年度四技二專統測重要時程" />
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>115年四技二專統測重要時程</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;500;700&display=swap">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;600;700;800&display=swap">
    <!-- QR Code 生成庫 -->
    <script src="https://cdn.jsdelivr.net/npm/qrcode-generator@1.4.4/qrcode.min.js"></script>
  </head>
  <body>
    <div class="app-container">
      <header class="app-header">
        <h1><i class="fas fa-calendar-alt"></i> 115年四技二專統測重要時程</h1>
        <p class="export-info">使用"匯出"按鈕可將時程匯出至 Google 日曆、Outlook 等行事曆應用。</p>
        <button id="menu-toggle" class="menu-toggle">
          <i class="fas fa-bars"></i>
        </button>
        <div id="side-menu" class="side-menu">
          <div class="menu-header">
            <h3><i class="fas fa-graduation-cap"></i> 統測導航</h3>
            <button id="menu-close" class="menu-close">
              <i class="fas fa-times"></i>
            </button>
          </div>
          <ul class="menu-list">
            <li class="menu-category">常用功能</li>
            <li><a href="#" class="menu-item active"><i class="fas fa-home"></i> 首頁儀表板</a></li>
            <li><a href="#" class="menu-item" onclick="openTab(event, 'tab5'); return false;"><i class="fas fa-pen"></i> 統測時程</a></li>
            <li><a href="#" class="menu-item" onclick="openTab(event, 'tab9'); return false;"><i class="fas fa-table"></i> 管道比較</a></li>
            
            <li class="menu-category">入學管道</li>
            <li><a href="#" class="menu-item" onclick="openTab(event, 'tab1'); return false;"><i class="fas fa-user-graduate"></i> 特殊選才</a></li>
            <li><a href="#" class="menu-item" onclick="openTab(event, 'tab2'); return false;"><i class="fas fa-star"></i> 科技繁星</a></li>
            <li><a href="#" class="menu-item" onclick="openTab(event, 'tab3'); return false;"><i class="fas fa-award"></i> 技優保送</a></li>
            <li><a href="#" class="menu-item" onclick="openTab(event, 'tab4'); return false;"><i class="fas fa-medal"></i> 技優甄審</a></li>
            <li><a href="#" class="menu-item" onclick="openTab(event, 'tab6'); return false;"><i class="fas fa-check-circle"></i> 甄選入學</a></li>
            <li><a href="#" class="menu-item" onclick="openTab(event, 'tab7'); return false;"><i class="fas fa-list-alt"></i> 聯合登記分發</a></li>
            <li><a href="#" class="menu-item" onclick="openTab(event, 'tab8'); return false;"><i class="fas fa-file-alt"></i> 申請入學</a></li>
            
            <li class="menu-category">外部資源</li>
            <li><a href="https://www.techadmi.edu.tw/bbs.php?bid=479" class="menu-item" target="_blank"><i class="fas fa-calendar-check"></i> 官方時程表</a></li>
            <li><a href="https://web1.tcte.edu.tw/EXAM/114_2y/" class="menu-item" target="_blank"><i class="fas fa-file-alt"></i> 歷年試題</a></li>
            <li><a href="https://www.jctv.ntut.edu.tw/" class="menu-item" target="_blank"><i class="fas fa-school"></i> 招委會官網</a></li>
          </ul>
          <div class="menu-footer">
            <button onclick="exportAllEvents()" class="menu-export-btn">
              <i class="fas fa-calendar-plus"></i> 匯出全部時程
            </button>
          </div>
        </div>
        <div id="overlay" class="overlay"></div>
      </header>
      
      <!-- 搜尋框 -->
      <div class="search-container">
        <div class="search-input-container">
          <i class="fas fa-search search-icon"></i>
          <input type="text" id="search-input" class="search-input" placeholder="搜尋重要時程..." />
          <button id="clear-search" class="clear-search">
            <i class="fas fa-times"></i>
          </button>
        </div>
      </div>

      <!-- 倒數計時區塊 -->
      <div class="countdown-container">
        <div class="countdown-header">
          <i class="fas fa-hourglass-half"></i>
          <h2>重要時程倒數</h2>
        </div>
        
        <div class="countdown-grid" id="dynamic-countdown-grid">
          <!-- 動態生成的倒數計時器將在這裡顯示 -->
        </div>
      </div>
      
      <!-- 使用說明區塊 -->
      <div class="guide-container">
        <div class="guide-header">
          <i class="fas fa-book"></i>
          <h2>網站使用說明</h2>
        </div>
        
        <div class="guide-content">
          <div class="guide-section">
            <div class="guide-icon">
              <i class="fas fa-search"></i>
            </div>
            <div class="guide-text">
              <h3>搜尋功能</h3>
              <p>在頂部搜尋框輸入關鍵字，可快速找到相關時程。系統會自動顯示包含該關鍵字的所有時程項目，並以黃色高亮顯示。</p>
            </div>
          </div>
          
          <div class="guide-section">
            <div class="guide-icon">
              <i class="fas fa-calendar-alt"></i>
            </div>
            <div class="guide-text">
              <h3>時程查詢</h3>
              <p>點擊上方頁籤可切換不同入學管道，查看詳細時程。每個時程項目皆包含日期和事件說明，按時間順序排列。</p>
            </div>
          </div>
          
          <div class="guide-section">
            <div class="guide-icon">
              <i class="fas fa-calendar-plus"></i>
            </div>
            <div class="guide-text">
              <h3>匯出功能</h3>
              <p>點擊「加入行事曆」按鈕可將時程事件匯出至 Google 日曆，點擊「設定提醒」可在事件前收到通知。也可使用側邊選單中的「匯出全部時程」功能。</p>
            </div>
          </div>
          
          <div class="guide-section">
            <div class="guide-icon">
              <i class="fas fa-share-alt"></i>
            </div>
            <div class="guide-text">
              <h3>分享功能</h3>
              <p>使用頁面底部的分享按鈕，可將網站分享給同學朋友，支援 Facebook、LINE、Email、連結複製及 QR Code 分享。</p>
            </div>
          </div>
        </div>
        
        <div class="guide-tip">
          <i class="fas fa-lightbulb"></i>
          <p>提示：建議保存此網頁，定期查看各項時程，以免錯過重要日期！</p>
        </div>
      </div>
      
      <!-- 最近即將進行的日程 -->
      <div class="upcoming-event-container">
        <div class="upcoming-header">
          <i class="fas fa-bell"></i>
          <h2>最近即將進行的日程</h2>
        </div>
        
        <div class="upcoming-card" id="next-event">
          <div class="event-status">
            <span class="status-label">即將到來</span>
            <span class="event-remaining" id="event-remaining-days">計算中...</span>
          </div>
          
          <div class="event-content">
            <div class="event-icon">
              <i class="fas fa-calendar-day"></i>
            </div>
            <div class="event-details">
              <div class="event-path" id="event-path">載入中...</div>
              <div class="event-name" id="event-name">載入中...</div>
              <div class="event-date" id="event-date">載入中...</div>
            </div>
          </div>
          
          <div class="event-actions">
            <button class="event-action-btn" onclick="addToCalendar()">
              <i class="fas fa-calendar-plus"></i>
              <span>加入行事曆</span>
            </button>
            <button class="event-action-btn" onclick="setReminder()">
              <i class="fas fa-bell"></i>
              <span>設定提醒</span>
            </button>
          </div>
        </div>
      </div>
      
      <main class="app-main">
        <div class="tabs">
          <div class="path-selector-container">
            <h3 class="path-selector-title"><i class="fas fa-route"></i> 選擇入學管道</h3>
            <div class="path-selector" id="dynamic-path-selector">
              <!-- 入學管道選擇器將在這裡動態生成 -->
            </div>
          </div>
          <div class="tab-header" id="dynamic-tab-header">
            <!-- 頁籤將動態生成，活躍的管道在前，已結束的管道在後 -->
          </div>
          
          <!-- 特殊選才 -->
          <div id="tab1" class="tab-content active">
            <div class="timeline-container">
              <h2><i class="fas fa-user-graduate"></i> 特殊選才</h2>
              <div class="description">
                <h3><i class="fas fa-info-circle"></i> 招收具特殊才能、不同教育資歷及青年儲蓄方案者</h3>
              </div>
              <div class="timeline">
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 114/12/15-19</div>
                    <div class="timeline-event">報名</div>
                  </div>
                </div>
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 115/1/23-31</div>
                    <div class="timeline-event">指定項目甄審</div>
                  </div>
                </div>
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 115/2/4-6</div>
                    <div class="timeline-event">登記就讀志願序</div>
                  </div>
                </div>
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 115/2/11</div>
                    <div class="timeline-event">放榜</div>
                  </div>
                </div>
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 115/3/3</div>
                    <div class="timeline-event">報到截止</div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          
          <!-- 科技繁星 -->
          <div id="tab2" class="tab-content">
            <div class="timeline-container">
              <h2><i class="fas fa-star"></i> 科技繁星</h2>
              <div class="description">
                <h3><i class="fas fa-info-circle"></i> 招收專業群科、綜高專門學程、校內推薦在校前30%應屆生</h3>
              </div>
              <div class="timeline">
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 115/3/11-18</div>
                    <div class="timeline-event">報名</div>
                  </div>
                </div>
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 115/4/22-28</div>
                    <div class="timeline-event">選填志願</div>
                  </div>
                </div>
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 115/5/5</div>
                    <div class="timeline-event">放榜</div>
                  </div>
                </div>
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 115/5/12</div>
                    <div class="timeline-event">放棄截止</div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          
          <!-- 技優保送 -->
          <div id="tab3" class="tab-content">
            <div class="timeline-container">
              <h2><i class="fas fa-award"></i> 技優保送</h2>
              <div class="description">
                <h3><i class="fas fa-info-circle"></i> 招收國際或全國技藝技能競賽前3名獲獎者或正備取國手</h3>
              </div>
              <div class="timeline">
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 115/3/4-6</div>
                    <div class="timeline-event">報名</div>
                  </div>
                </div>
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 115/3/9-11</div>
                    <div class="timeline-event">選填志願</div>
                  </div>
                </div>
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 115/3/17</div>
                    <div class="timeline-event">放榜</div>
                  </div>
                </div>
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 115/3/25</div>
                    <div class="timeline-event">報到截止</div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          
          <!-- 技優甄審 -->
          <div id="tab4" class="tab-content">
            <div class="timeline-container">
              <h2><i class="fas fa-medal"></i> 技優甄審</h2>
              <div class="description">
                <h3><i class="fas fa-info-circle"></i> 招收技藝技能競賽得獎、取得專技普考證書或乙級以上技術士證者</h3>
              </div>
              <div class="timeline">
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 115/4/29-5/6</div>
                    <div class="timeline-event">資格審查登錄</div>
                  </div>
                </div>
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 115/5/18-22</div>
                    <div class="timeline-event">報名</div>
                  </div>
                </div>
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 115/6/4-9</div>
                    <div class="timeline-event">網路上傳(或勾選)備審資料</div>
                  </div>
                </div>
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 115/6/12-21</div>
                    <div class="timeline-event">指定項目甄審</div>
                  </div>
                </div>
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 115/7/1-3</div>
                    <div class="timeline-event">登記就讀志願序</div>
                  </div>
                </div>
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 115/7/7</div>
                    <div class="timeline-event">放榜</div>
                  </div>
                </div>
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 115/7/15</div>
                    <div class="timeline-event">報到截止</div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          
          <!-- 統一入學測驗 -->
          <div id="tab5" class="tab-content">
            <div class="timeline-container">
              <h2><i class="fas fa-pen"></i> 統一入學測驗</h2>
              <div class="description">
                <h3><i class="fas fa-info-circle"></i> 四技二專統一入學測驗</h3>
              </div>
              <div class="timeline">
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 113/12/6-18</div>
                    <div class="timeline-event">報名</div>
                  </div>
                </div>
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 114/3/19</div>
                    <div class="timeline-event">寄發准考證</div>
                  </div>
                </div>
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 114/4/26-27</div>
                    <div class="timeline-event">統測</div>
                  </div>
                </div>
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 114/5/15</div>
                    <div class="timeline-event">寄發成績單</div>
                  </div>
                </div>
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 114/5/23</div>
                    <div class="timeline-event">成績複查</div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          
          <!-- 甄選入學 -->
          <div id="tab6" class="tab-content">
            <div class="timeline-container">
              <h2><i class="fas fa-check-circle"></i> 甄選入學</h2>
              <div class="description">
                <h3><i class="fas fa-info-circle"></i> 招收專業群科、綜高專門學程、非應屆普通科或青年儲蓄方案者</h3>
              </div>
              <div class="timeline">
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 115/4/16-29</div>
                    <div class="timeline-event">資格審查登錄</div>
                  </div>
                </div>
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 115/5/14-18</div>
                    <div class="timeline-event">應屆生查詢第6學期修課紀錄</div>
                  </div>
                </div>
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 115/5/15-22</div>
                    <div class="timeline-event">報名</div>
                  </div>
                </div>
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 115/6/5-12</div>
                    <div class="timeline-event">網路上傳(或勾選)備審資料</div>
                  </div>
                </div>
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 115/6/13-28</div>
                    <div class="timeline-event">二階甄試</div>
                  </div>
                </div>
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 115/7/8-10</div>
                    <div class="timeline-event">登記就讀志願序</div>
                  </div>
                </div>
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 115/7/14</div>
                    <div class="timeline-event">放榜</div>
                  </div>
                </div>
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 115/7/16-20</div>
                    <div class="timeline-event">報到</div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          
          <!-- 聯合登記分發 -->
          <div id="tab7" class="tab-content">
            <div class="timeline-container">
              <h2><i class="fas fa-list-alt"></i> 聯合登記分發</h2>
              <div class="description">
                <h3><i class="fas fa-info-circle"></i> 招收專業群科、綜合高中或非應屆普通科學力者</h3>
              </div>
              <div class="timeline">
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 115/5/4-8</div>
                    <div class="timeline-event">資格審查登錄</div>
                  </div>
                </div>
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 115/7/14-22</div>
                    <div class="timeline-event">報名</div>
                  </div>
                </div>
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 115/7/27</div>
                    <div class="timeline-event">公告實際招生名額</div>
                  </div>
                </div>
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 115/7/28-31</div>
                    <div class="timeline-event">選填志願</div>
                  </div>
                </div>
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 115/8/6</div>
                    <div class="timeline-event">放榜</div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          
          <!-- 申請入學 -->
          <div id="tab8" class="tab-content">
            <div class="timeline-container">
              <h2><i class="fas fa-file-alt"></i> 申請入學</h2>
              <div class="description">
                <h3><i class="fas fa-info-circle"></i> 招收高中普通科或其他符合四技申請入學資格者</h3>
              </div>
              <div class="timeline">
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 115/1/17-19</div>
                    <div class="timeline-event">學測</div>
                  </div>
                </div>
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 115/3/19-25</div>
                    <div class="timeline-event">報名</div>
                  </div>
                </div>
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 115/4/30-5/6</div>
                    <div class="timeline-event">網路上傳(或勾選)備審資料</div>
                  </div>
                </div>
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 115/5/11-12</div>
                    <div class="timeline-event">應屆生查詢第6學期修課紀錄</div>
                  </div>
                </div>
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 115/5/14-26</div>
                    <div class="timeline-event">二階複試</div>
                  </div>
                </div>
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 115/5/29前</div>
                    <div class="timeline-event">各校公告正備取生名單</div>
                  </div>
                </div>
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 115/6/12</div>
                    <div class="timeline-event">正取報到截止</div>
                  </div>
                </div>
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 115/6/14</div>
                    <div class="timeline-event">備取遞補截止</div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          
          <!-- 招生管道比較 -->
          <div id="tab9" class="tab-content">
            <div class="timeline-container">
              <h2><i class="fas fa-table"></i> 四技二專招生管道比較</h2>
              <div class="description">
                <h3><i class="fas fa-info-circle"></i> 各招生管道的招收對象與是否採計統測成績</h3>
              </div>
              
              <div class="table-container">
                <table class="compare-table">
                  <thead>
                    <tr>
                      <th><i class="fas fa-route"></i> 招生管道</th>
                      <th><i class="fas fa-users"></i> 招收對象</th>
                      <th><i class="fas fa-clipboard-check"></i> 採計成績</th>
                      <th><i class="fas fa-calendar-alt"></i> 主要日程</th>
                    </tr>
                  </thead>
                  <tbody>
                    <!-- 特殊選才 -->
                    <tr>
                      <td class="path-name"><i class="fas fa-user-graduate"></i> 特殊選才</td>
                      <td>
                        <span class="target-audience">具特殊才能、不同教育資歷及青年儲蓄方案者</span>
                        <div class="detail-list">
                          <span class="detail-item"><i class="fas fa-circle"></i> 特殊才能或專長</span>
                          <span class="detail-item"><i class="fas fa-circle"></i> 特殊經歷或成就</span>
                          <span class="detail-item"><i class="fas fa-circle"></i> 青年儲蓄方案</span>
                        </div>
                      </td>
                      <td class="no-exam">免統測</td>
                      <td>
                        <div class="timeline-mini">
                          <div class="timeline-mini-item">
                            <span class="mini-date">114/12/15-19</span>
                            <span class="mini-event">報名</span>
                          </div>
                          <div class="timeline-mini-item">
                            <span class="mini-date">115/1/23-31</span>
                            <span class="mini-event">指定項目甄審</span>
                          </div>
                          <div class="timeline-mini-item">
                            <span class="mini-date">115/2/11</span>
                            <span class="mini-event">放榜</span>
                          </div>
                        </div>
                      </td>
                    </tr>
                    
                    <!-- 科技繁星 -->
                    <tr>
                      <td class="path-name"><i class="fas fa-star"></i> 科技繁星</td>
                      <td>
                        <span class="target-audience">校內推薦在校前30%應屆生</span>
                        <div class="detail-list">
                          <span class="detail-item"><i class="fas fa-circle"></i> 專業群科</span>
                          <span class="detail-item"><i class="fas fa-circle"></i> 綜高專門學程</span>
                          <span class="detail-item"><i class="fas fa-circle"></i> 實習幹部等符合推薦標準</span>
                        </div>
                      </td>
                      <td class="no-exam">免統測</td>
                      <td>
                        <div class="timeline-mini">
                          <div class="timeline-mini-item">
                            <span class="mini-date">115/3/11-18</span>
                            <span class="mini-event">報名</span>
                          </div>
                          <div class="timeline-mini-item">
                            <span class="mini-date">115/4/22-28</span>
                            <span class="mini-event">選填志願</span>
                          </div>
                          <div class="timeline-mini-item">
                            <span class="mini-date">115/5/5</span>
                            <span class="mini-event">放榜</span>
                          </div>
                        </div>
                      </td>
                    </tr>
                    
                    <!-- 技優保送 -->
                    <tr>
                      <td class="path-name"><i class="fas fa-award"></i> 技優保送</td>
                      <td>
                        <span class="target-audience">國際或全國技藝技能競賽優勝者</span>
                        <div class="detail-list">
                          <span class="detail-item"><i class="fas fa-circle"></i> 國際技能競賽</span>
                          <span class="detail-item"><i class="fas fa-circle"></i> 全國技能競賽前3名</span>
                          <span class="detail-item"><i class="fas fa-circle"></i> 國手正備取選手</span>
                        </div>
                      </td>
                      <td class="no-exam">免統測</td>
                      <td>
                        <div class="timeline-mini">
                          <div class="timeline-mini-item">
                            <span class="mini-date">115/3/4-6</span>
                            <span class="mini-event">報名</span>
                          </div>
                          <div class="timeline-mini-item">
                            <span class="mini-date">115/3/9-11</span>
                            <span class="mini-event">選填志願</span>
                          </div>
                          <div class="timeline-mini-item">
                            <span class="mini-date">115/3/17</span>
                            <span class="mini-event">放榜</span>
                          </div>
                        </div>
                      </td>
                    </tr>
                    
                    <!-- 技優甄審 -->
                    <tr>
                      <td class="path-name"><i class="fas fa-medal"></i> 技優甄審</td>
                      <td>
                        <span class="target-audience">技藝競賽得獎或持有證照者</span>
                        <div class="detail-list">
                          <span class="detail-item"><i class="fas fa-circle"></i> 技藝技能競賽獲獎</span>
                          <span class="detail-item"><i class="fas fa-circle"></i> 專技普考證書</span>
                          <span class="detail-item"><i class="fas fa-circle"></i> 乙級以上技術士證</span>
                        </div>
                      </td>
                      <td class="no-exam">免統測</td>
                      <td>
                        <div class="timeline-mini">
                          <div class="timeline-mini-item">
                            <span class="mini-date">115/4/29-5/6</span>
                            <span class="mini-event">資格審查</span>
                          </div>
                          <div class="timeline-mini-item">
                            <span class="mini-date">115/5/18-22</span>
                            <span class="mini-event">報名</span>
                          </div>
                          <div class="timeline-mini-item">
                            <span class="mini-date">115/7/7</span>
                            <span class="mini-event">放榜</span>
                          </div>
                        </div>
                      </td>
                    </tr>
                    
                    <!-- 統一入學測驗 -->
                    <tr class="highlight-row">
                      <td class="path-name"><i class="fas fa-pen"></i> 統一入學測驗</td>
                      <td>
                        <span class="target-audience">四技二專統一入學測驗</span>
                        <div class="detail-list">
                          <span class="detail-item"><i class="fas fa-circle"></i> 高職學生</span>
                          <span class="detail-item"><i class="fas fa-circle"></i> 綜合高中專門學程</span>
                          <span class="detail-item"><i class="fas fa-circle"></i> 普通高中同等學力者</span>
                        </div>
                      </td>
                      <td class="yes-exam">必考</td>
                      <td>
                        <div class="timeline-mini">
                          <div class="timeline-mini-item">
                            <span class="mini-date">114/12/6-18</span>
                            <span class="mini-event">報名</span>
                          </div>
                          <div class="timeline-mini-item highlight-event">
                            <span class="mini-date">115/4/26-27</span>
                            <span class="mini-event">統測</span>
                          </div>
                          <div class="timeline-mini-item">
                            <span class="mini-date">115/5/15</span>
                            <span class="mini-event">寄發成績單</span>
                          </div>
                        </div>
                      </td>
                    </tr>
                    
                    <!-- 甄選入學 -->
                    <tr>
                      <td class="path-name"><i class="fas fa-check-circle"></i> 甄選入學</td>
                      <td>
                        <span class="target-audience">高職或非普通科應屆生</span>
                        <div class="detail-list">
                          <span class="detail-item"><i class="fas fa-circle"></i> 專業群科</span>
                          <span class="detail-item"><i class="fas fa-circle"></i> 綜高專門學程</span>
                          <span class="detail-item"><i class="fas fa-circle"></i> 非應屆普通科</span>
                          <span class="detail-item"><i class="fas fa-circle"></i> 青年儲蓄方案</span>
                        </div>
                      </td>
                      <td class="yes-exam">採計統測</td>
                      <td>
                        <div class="timeline-mini">
                          <div class="timeline-mini-item">
                            <span class="mini-date">115/5/15-22</span>
                            <span class="mini-event">報名</span>
                          </div>
                          <div class="timeline-mini-item">
                            <span class="mini-date">115/6/13-28</span>
                            <span class="mini-event">二階甄試</span>
                          </div>
                          <div class="timeline-mini-item">
                            <span class="mini-date">115/7/14</span>
                            <span class="mini-event">放榜</span>
                          </div>
                        </div>
                      </td>
                    </tr>
                    
                    <!-- 聯合登記分發 -->
                    <tr>
                      <td class="path-name"><i class="fas fa-list-alt"></i> 聯合登記分發</td>
                      <td>
                        <span class="target-audience">高職或非應屆普通科學力者</span>
                        <div class="detail-list">
                          <span class="detail-item"><i class="fas fa-circle"></i> 專業群科</span>
                          <span class="detail-item"><i class="fas fa-circle"></i> 綜合高中</span>
                          <span class="detail-item"><i class="fas fa-circle"></i> 非應屆普通科</span>
                        </div>
                      </td>
                      <td class="yes-exam">採計統測</td>
                      <td>
                        <div class="timeline-mini">
                          <div class="timeline-mini-item">
                            <span class="mini-date">115/7/14-22</span>
                            <span class="mini-event">報名</span>
                          </div>
                          <div class="timeline-mini-item">
                            <span class="mini-date">115/7/28-31</span>
                            <span class="mini-event">選填志願</span>
                          </div>
                          <div class="timeline-mini-item">
                            <span class="mini-date">115/8/6</span>
                            <span class="mini-event">放榜</span>
                          </div>
                        </div>
                      </td>
                    </tr>
                    
                    <!-- 申請入學 -->
                    <tr>
                      <td class="path-name"><i class="fas fa-file-alt"></i> 申請入學</td>
                      <td>
                        <span class="target-audience">高中普通科</span>
                        <div class="detail-list">
                          <span class="detail-item"><i class="fas fa-circle"></i> 普通高中</span>
                          <span class="detail-item"><i class="fas fa-circle"></i> 綜高學術學程</span>
                          <span class="detail-item"><i class="fas fa-circle"></i> 其他學測成績採計對象</span>
                        </div>
                      </td>
                      <td class="other-exam">採計學測</td>
                      <td>
                        <div class="timeline-mini">
                          <div class="timeline-mini-item">
                            <span class="mini-date">115/1/17-19</span>
                            <span class="mini-event">學測</span>
                          </div>
                          <div class="timeline-mini-item">
                            <span class="mini-date">115/3/19-25</span>
                            <span class="mini-event">報名</span>
                          </div>
                          <div class="timeline-mini-item">
                            <span class="mini-date">115/5/29前</span>
                            <span class="mini-event">各校公告結果</span>
                          </div>
                        </div>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
              
              <div class="compare-note">
                <p><i class="fas fa-lightbulb"></i> 選擇招生管道小提示：</p>
                <ul>
                  <li>「<span class="note-highlight">免統測</span>」管道可以不必參加統一入學測驗，適合有特殊專長或成就的學生。</li>
                  <li>「<span class="note-highlight">採計統測</span>」管道需要參加四技二專統測，適合想透過筆試展現實力的學生。</li>
                  <li>多個管道可以同時報名，但要注意各管道時程是否重疊。</li>
                  <li>各管道錄取後有報到期限，若同時錄取多個管道，需在期限內決定就讀學校。</li>
                  <li>詳細資訊請參考<a href="https://www.jctv.ntut.edu.tw/" target="_blank">技專校院招生委員會聯合會</a>公告。</li>
                </ul>
              </div>
              
              <div class="compare-chart">
                <div class="chart-header">
                  <i class="fas fa-chart-pie"></i> 招生管道時程分布圖
                </div>
                <div class="timeline-chart">
                  <div class="month-labels">
                    <span>1月</span>
                    <span>2月</span>
                    <span>3月</span>
                    <span>4月</span>
                    <span>5月</span>
                    <span>6月</span>
                    <span>7月</span>
                    <span>8月</span>
                  </div>
                  
                  <div class="chart-paths">
                    <div class="chart-path">
                      <div class="path-label"><i class="fas fa-user-graduate"></i> 特殊選才</div>
                      <div class="path-bar">
                        <div class="bar-segment" style="left: 0%; width: 16.7%; background-color: rgba(64, 158, 255, 0.15);">報名</div>
                        <div class="bar-segment" style="left: 16.7%; width: 12.5%; background-color: rgba(100, 170, 255, 0.2);">甄審</div>
                        <div class="bar-segment highlight" style="left: 29.2%; width: 4.2%;">放榜</div>
                      </div>
                    </div>
                    
                    <div class="chart-path">
                      <div class="path-label"><i class="fas fa-star"></i> 科技繁星</div>
                      <div class="path-bar">
                        <div class="bar-segment" style="left: 33.3%; width: 12.5%; background-color: rgba(64, 158, 255, 0.15);">報名</div>
                        <div class="bar-segment" style="left: 45.8%; width: 8.3%; background-color: rgba(100, 170, 255, 0.2);">選志願</div>
                        <div class="bar-segment highlight" style="left: 54.1%; width: 4.2%;">放榜</div>
                      </div>
                    </div>
                    
                    <div class="chart-path">
                      <div class="path-label"><i class="fas fa-award"></i> 技優保送</div>
                      <div class="path-bar">
                        <div class="bar-segment" style="left: 16.7%; width: 8.3%; background-color: rgba(64, 158, 255, 0.15);">報名</div>
                        <div class="bar-segment" style="left: 25%; width: 8.3%; background-color: rgba(100, 170, 255, 0.2);">選志願</div>
                        <div class="bar-segment highlight" style="left: 33.3%; width: 4.2%;">放榜</div>
                      </div>
                    </div>
                    
                    <div class="chart-path">
                      <div class="path-label"><i class="fas fa-medal"></i> 技優甄審</div>
                      <div class="path-bar">
                        <div class="bar-segment" style="left: 49%; width: 8.3%; background-color: rgba(64, 158, 255, 0.15);">資格審查</div>
                        <div class="bar-segment" style="left: 57.3%; width: 20%; background-color: rgba(100, 170, 255, 0.2);">甄審</div>
                        <div class="bar-segment highlight" style="left: 77.3%; width: 4.2%;">放榜</div>
                      </div>
                    </div>
                    
                    <div class="chart-path highlight-path">
                      <div class="path-label"><i class="fas fa-pen"></i> 統一入學測驗</div>
                      <div class="path-bar">
                        <div class="bar-segment" style="left: 0%; width: 16.7%; background-color: rgba(239, 68, 68, 0.1);">報名</div>
                        <div class="bar-segment" style="left: 33.3%; width: 4.2%; background-color: rgba(239, 68, 68, 0.15);">准考證</div>
                        <div class="bar-segment highlight danger" style="left: 45.8%; width: 8.3%;">統測</div>
                        <div class="bar-segment" style="left: 54.1%; width: 4.2%; background-color: rgba(239, 68, 68, 0.15);">成績</div>
                      </div>
                    </div>
                    
                    <div class="chart-path">
                      <div class="path-label"><i class="fas fa-check-circle"></i> 甄選入學</div>
                      <div class="path-bar">
                        <div class="bar-segment" style="left: 41.7%; width: 12.5%; background-color: rgba(16, 185, 129, 0.1);">資格審查</div>
                        <div class="bar-segment" style="left: 54.2%; width: 8.3%; background-color: rgba(16, 185, 129, 0.15);">報名</div>
                        <div class="bar-segment" style="left: 62.5%; width: 20.8%; background-color: rgba(16, 185, 129, 0.2);">二階甄試</div>
                        <div class="bar-segment highlight success" style="left: 83.3%; width: 4.2%;">放榜</div>
                      </div>
                    </div>
                    
                    <div class="chart-path">
                      <div class="path-label"><i class="fas fa-list-alt"></i> 聯合登記分發</div>
                      <div class="path-bar">
                        <div class="bar-segment" style="left: 52.1%; width: 25%; background-color: rgba(245, 158, 11, 0.1);">資格審查</div>
                        <div class="bar-segment" style="left: 83.3%; width: 8.3%; background-color: rgba(245, 158, 11, 0.15);">報名</div>
                        <div class="bar-segment" style="left: 91.7%; width: 4.2%; background-color: rgba(245, 158, 11, 0.2);">志願</div>
                        <div class="bar-segment highlight warning" style="left: 95.8%; width: 4.2%;">放榜</div>
                      </div>
                    </div>
                    
                    <div class="chart-path">
                      <div class="path-label"><i class="fas fa-file-alt"></i> 申請入學</div>
                      <div class="path-bar">
                        <div class="bar-segment highlight" style="left: 4.2%; width: 8.3%; background-color: rgba(139, 92, 246, 0.3);">學測</div>
                        <div class="bar-segment" style="left: 33.3%; width: 8.3%; background-color: rgba(139, 92, 246, 0.15);">報名</div>
                        <div class="bar-segment" style="left: 52.1%; width: 16.7%; background-color: rgba(139, 92, 246, 0.2);">二階複試</div>
                        <div class="bar-segment" style="left: 68.8%; width: 4.2%; background-color: rgba(139, 92, 246, 0.15);">報到</div>
                      </div>
                    </div>
                  </div>
                </div>
                
                <div class="chart-legend">
                  <div class="legend-item">
                    <span class="legend-color" style="background-color: rgba(64, 150, 255, 0.3);"></span>
                    <span class="legend-text">放榜日期</span>
                  </div>
                  <div class="legend-item">
                    <span class="legend-color" style="background-color: rgba(239, 68, 68, 0.3);"></span>
                    <span class="legend-text">統測日期</span>
                  </div>
                  <div class="legend-item">
                    <span class="legend-color" style="background-color: rgba(139, 92, 246, 0.3);"></span>
                    <span class="legend-text">學測日期</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </main>
      
      <!-- 分享區塊 -->
      <div class="share-container">
        <h3><i class="fas fa-share-alt"></i> 分享給同學</h3>
        <div class="share-buttons">
          <button class="share-button" onclick="shareOnFacebook()">
            <i class="fab fa-facebook-f"></i>
          </button>
          <button class="share-button" onclick="shareOnLine()">
            <i class="fab fa-line"></i>
          </button>
          <button class="share-button" onclick="shareByEmail()">
            <i class="fas fa-envelope"></i>
          </button>
          <button class="share-button" onclick="copyShareLink()">
            <i class="fas fa-link"></i>
          </button>
          <button class="share-button" onclick="showQRCode()">
            <i class="fas fa-qrcode"></i>
          </button>
        </div>
        <div id="copy-message" class="copy-message">連結已複製！</div>
      </div>
      
      <!-- QR Code 模態視窗 -->
      <div id="qrcode-modal" class="modal">
        <div class="modal-content">
          <div class="modal-header">
            <h3><i class="fas fa-qrcode"></i> 掃描QR Code分享</h3>
            <button class="modal-close" onclick="closeQRModal()">
              <i class="fas fa-times"></i>
            </button>
          </div>
          <div class="modal-body">
            <div id="qrcode-display" class="qrcode-display"></div>
            <p class="qrcode-help">掃描QR Code即可在手機上開啟</p>
          </div>
        </div>
      </div>
      
      <footer class="app-footer">
        <p>© <span id="current-year"></span> 115年四技二專統測重要時程</p>
      </footer>
    </div>

    <!-- 浮動回到頂部按鈕 -->
    <div id="back-to-top" class="floating-button">
      <button aria-label="回到頂部">
        <i class="fas fa-arrow-up"></i>
      </button>
    </div>

    <!-- 手機版底部導航 -->
    <div class="mobile-nav">
      <button class="mobile-nav-btn" onclick="openTab(event, 'tab5')">
        <i class="fas fa-pen"></i>
        <span>統測</span>
      </button>
      <button class="mobile-nav-btn" onclick="document.getElementById('search-input').focus()">
        <i class="fas fa-search"></i>
        <span>搜尋</span>
      </button>
      <button class="mobile-nav-btn" onclick="openMobileMenu()">
        <i class="fas fa-bars"></i>
        <span>選單</span>
      </button>
      <button class="mobile-nav-btn" onclick="exportAllEvents()">
        <i class="fas fa-calendar-plus"></i>
        <span>匯出</span>
      </button>
    </div>
    
    <script>
      // 處理手機版菜單打開
      function openMobileMenu() {
        // 先更新側邊選單內容
        updateSideMenu();
        // 再顯示選單
        document.getElementById('menu-toggle').click();
      }
    </script>

    <script>
      // 設置當前年份
      document.getElementById('current-year').textContent = new Date().getFullYear();
      
      // 頁籤切換功能
      function openTab(evt, tabId) {
        // 隱藏所有頁籤內容
        var tabContents = document.getElementsByClassName("tab-content");
        for (var i = 0; i < tabContents.length; i++) {
          tabContents[i].classList.remove("active");
        }
        
        // 顯示當前頁籤內容
        const tabContent = document.getElementById(tabId);
        if (tabContent) {
          tabContent.classList.add("active");
        }
        
        // 移除所有入學管道卡片的active類別
        document.querySelectorAll('.path-card').forEach(card => {
          card.classList.remove('active');
        });
        
        // 移除所有選單路徑卡片的active類別
        document.querySelectorAll('.menu-path-card').forEach(card => {
          card.classList.remove('active');
        });
        
        // 添加active類別給對應的入學管道卡片
        const pathCard = document.querySelector(`.path-card[data-tab="${tabId}"]`);
        if (pathCard) {
          pathCard.classList.add('active');
        }
        
        // 添加active類別給對應的選單路徑卡片
        const menuPathCard = document.querySelector(`.menu-path-card[onclick*="${tabId}"]`);
        if (menuPathCard) {
          menuPathCard.classList.add('active');
        }
        
        // 切換頁籤後更新事件狀態
        updateTimelineItemsStatus();
        
        // 關閉側邊選單（如果是在移動設備上）
        if (window.innerWidth < 768) {
          closeMenu();
        }
        
        // 滾動到頁面頂部（平滑滾動）
        window.scrollTo({
          top: 0,
          behavior: 'smooth'
        });
      }

      // 側邊選單功能
      document.addEventListener('DOMContentLoaded', function() {
        // 綁定菜單按鈕事件
        document.getElementById('menu-toggle').addEventListener('click', function() {
          document.getElementById('side-menu').classList.add('active');
          document.getElementById('overlay').classList.add('active');
          document.body.classList.add('no-scroll');
          
          // 打開菜單時更新選單內容
          updateSideMenu();
        });

        document.getElementById('menu-close').addEventListener('click', closeMenu);
        document.getElementById('overlay').addEventListener('click', closeMenu);
      });
      
      function closeMenu() {
        document.getElementById('side-menu').classList.remove('active');
        document.getElementById('overlay').classList.remove('active');
        document.body.classList.remove('no-scroll');
      }

      // 解析中華民國日期和時間格式 (例如 113/12/16 14:00)
      function parseROCDate(dateStr, timeStr = '00:00') {
        // 處理類似 113/12/16-20 的日期範圍，僅取開始日期
        if (dateStr.includes('-')) {
          dateStr = dateStr.split('-')[0];
        }
        
        // 分解日期部分
        const parts = dateStr.split('/');
        if (parts.length >= 3) {
          // 轉換民國年為西元年
          const year = parseInt(parts[0]) + 1911;
          const month = parseInt(parts[1]) - 1; // JavaScript月份從0開始
          const day = parseInt(parts[2]);
          
          // 分解時間部分
          const timeParts = timeStr.split(':');
          const hour = parseInt(timeParts[0]) || 0;
          const minute = parseInt(timeParts[1]) || 0;
          
          return new Date(year, month, day, hour, minute, 0);
        }
        
        // 預設返回當前日期
        return new Date();
      }
      
      // 獲取日期範圍的結束日期 (例如 113/12/16-20)
      function parseROCEndDate(dateStr, timeStr = '23:59') {
        // 處理類似 113/12/16-20 的日期範圍
        if (dateStr.includes('-')) {
          const rangeParts = dateStr.split('-');
          const startDateParts = rangeParts[0].split('/');
          
          // 如果範圍指定了結束日
          if (rangeParts[1] && rangeParts[1].trim() !== '') {
            const endDay = parseInt(rangeParts[1]);
            const year = parseInt(startDateParts[0]) + 1911;
            const month = parseInt(startDateParts[1]) - 1; // JavaScript月份從0開始
            
            // 分解時間部分
            const timeParts = timeStr.split(':');
            const hour = parseInt(timeParts[0]) || 23;
            const minute = parseInt(timeParts[1]) || 59;
            
            return new Date(year, month, endDay, hour, minute, 0);
          }
        }
        
        // 如果沒有範圍，返回起始日期的當天結束時間
        return new Date(parseROCDate(dateStr, '23:59'));
      }
      
      // 更新所有時程項目的狀態
      function updateTimelineItemsStatus() {
        const timelineItems = document.querySelectorAll('.timeline-item');
        const now = new Date();
        
        timelineItems.forEach(item => {
          const dateElement = item.querySelector('.timeline-date');
          if (!dateElement) return;
          
          const dateText = dateElement.textContent;
          // 解析日期文字，通常格式為: 113/12/16-20
          const dateMatch = dateText.match(/(\d+\/\d+\/\d+(?:-\d+)?)/);
          if (!dateMatch) return;
          
          const dateStr = dateMatch[1];
          let timeStr = '00:00';
          
          // 解析起始日期和結束日期
          const startDate = parseROCDate(dateStr, timeStr);
          const endDate = parseROCEndDate(dateStr, '23:59');
          
          // 創建狀態指示器
          let statusHTML = '';
          let statusClass = '';
          
          if (now > endDate) {
            statusHTML = '<i class="fas fa-check-circle"></i> 已結束';
            statusClass = 'event-completed';
          } else if (now >= startDate && now <= endDate) {
            statusHTML = '<i class="fas fa-play-circle"></i> 進行中';
            statusClass = 'event-in-progress';
          } else {
            // 判斷是否即將開始（7天內）
            const daysUntilStart = Math.ceil((startDate - now) / (1000 * 60 * 60 * 24));
            
            if (daysUntilStart <= 7) {
              statusHTML = `<i class="fas fa-clock"></i> ${daysUntilStart}天後`;
              statusClass = 'event-soon';
            } else {
              statusHTML = '<i class="fas fa-calendar-plus"></i> 未開始';
              statusClass = 'event-upcoming';
            }
          }
          
          // 檢查是否已有狀態元素
          let statusElement = item.querySelector('.event-status');
          
          if (!statusElement) {
            // 創建狀態元素
            statusElement = document.createElement('div');
            statusElement.className = 'event-status';
            item.querySelector('.timeline-card').appendChild(statusElement);
          }
          
          // 更新狀態
          statusElement.innerHTML = statusHTML;
          statusElement.className = `event-status ${statusClass}`;
          
          // 更新整個卡片的樣式
          const timelineCard = item.querySelector('.timeline-card');
          timelineCard.classList.remove('event-completed', 'event-in-progress', 'event-soon', 'event-upcoming');
          timelineCard.classList.add(statusClass);
        });
      }
      
      // 當文檔加載完成後初始化
      document.addEventListener('DOMContentLoaded', function() {
        // 添加狀態指示器的樣式
        const styleElement = document.createElement('style');
        styleElement.textContent = `
          .event-status {
            position: absolute;
            right: 10px;
            top: 10px;
            font-size: 0.8rem;
            padding: 3px 8px;
            border-radius: 12px;
            font-weight: 500;
          }
          
          .event-completed {
            background-color: rgba(74, 222, 128, 0.2);
            color: #15803d;
          }
          
          .event-completed.event-status {
            border: 1px solid rgba(74, 222, 128, 0.4);
          }
          
          .event-in-progress {
            background-color: rgba(251, 146, 60, 0.2);
            color: #c2410c;
          }
          
          .event-in-progress.event-status {
            border: 1px solid rgba(251, 146, 60, 0.4);
            animation: pulse 2s infinite;
          }
          
          .event-soon {
            background-color: rgba(216, 180, 254, 0.2);
            color: #7e22ce;
          }
          
          .event-soon.event-status {
            border: 1px solid rgba(216, 180, 254, 0.4);
          }
          
          .event-upcoming {
            background-color: rgba(96, 165, 250, 0.2);
            color: #1d4ed8;
          }
          
          .event-upcoming.event-status {
            border: 1px solid rgba(96, 165, 250, 0.4);
          }
          
          .timeline-card.event-in-progress {
            box-shadow: 0 2px 12px rgba(251, 146, 60, 0.3);
            border-left: 4px solid #f97316;
          }
          
          .timeline-card.event-soon {
            box-shadow: 0 2px 8px rgba(216, 180, 254, 0.3);
            border-left: 4px solid #c084fc;
          }
          
          .timeline-card.event-completed {
            opacity: 0.8;
            border-left: 4px solid #4ade80;
          }
          
          @keyframes pulse {
            0% {
              box-shadow: 0 0 0 0 rgba(251, 146, 60, 0.4);
            }
            70% {
              box-shadow: 0 0 0 6px rgba(251, 146, 60, 0);
            }
            100% {
              box-shadow: 0 0 0 0 rgba(251, 146, 60, 0);
            }
          }
        `;
        document.head.appendChild(styleElement);
        
        // 初始化所有事件狀態
        updateTimelineItemsStatus();
        
        // 每小時更新一次狀態
        setInterval(updateTimelineItemsStatus, 60 * 60 * 1000);
      });

      // 回到頂部按鈕功能
      const backToTopButton = document.getElementById('back-to-top');
      
      window.addEventListener('scroll', () => {
        if (window.scrollY > 300) {
          backToTopButton.classList.add('show');
        } else {
          backToTopButton.classList.remove('show');
        }
      });
      
      backToTopButton.addEventListener('click', () => {
        window.scrollTo({
          top: 0,
          behavior: 'smooth'
        });
      });
      
      // 搜尋功能
      const searchInput = document.getElementById('search-input');
      const clearSearch = document.getElementById('clear-search');
      
      searchInput.addEventListener('input', performSearch);
      clearSearch.addEventListener('click', clearSearchField);
      
      function performSearch() {
        const searchTerm = searchInput.value.toLowerCase();
        const timelineItems = document.querySelectorAll('.timeline-item');
        const tabContents = document.querySelectorAll('.tab-content');
        const tabs = document.querySelectorAll('.tab-button');
        
        // 如果搜尋框為空，顯示所有內容並返回預設頁籤
        if (searchTerm === '') {
          timelineItems.forEach(item => {
            item.style.display = '';
            item.classList.remove('highlight');
          });
          
          // 顯示當前激活頁籤
          tabContents.forEach(tab => {
            if (tab.classList.contains('active')) {
              tab.style.display = 'block';
            } else {
              tab.style.display = 'none';
            }
          });
          
          return;
        }
        
        // 顯示所有頁籤內容以便搜尋
        tabContents.forEach(tab => {
          tab.style.display = 'block';
        });
        
        // 取消所有頁籤的激活狀態
        tabs.forEach(tab => {
          tab.classList.remove('active');
        });
        
        let hasResults = false;
        
        // 搜尋事件
        timelineItems.forEach(item => {
          const dateText = item.querySelector('.timeline-date').textContent.toLowerCase();
          const eventText = item.querySelector('.timeline-event').textContent.toLowerCase();
          
          if (dateText.includes(searchTerm) || eventText.includes(searchTerm)) {
            item.style.display = '';
            item.classList.add('highlight');
            hasResults = true;
            
            // 找到該項目所在的頁籤並顯示
            const parentTab = item.closest('.tab-content');
            if (parentTab) {
              const tabId = parentTab.id;
              document.querySelector(`button[onclick*="${tabId}"]`).classList.add('active');
            }
          } else {
            item.style.display = 'none';
            item.classList.remove('highlight');
          }
        });
        
        // 如果沒有結果，顯示提示訊息
        if (!hasResults) {
          // 可以添加一個沒有結果的訊息元素
          console.log('沒有符合的結果');
        }
      }
      
      function clearSearchField() {
        searchInput.value = '';
        performSearch();
      }

      // 所有活動數據
      const allEvents = [
        ["特殊選才", "報名", "114/12/15", "00:00", "報名", "fa-edit"],
        ["特殊選才", "指定項目甄審", "115/1/23", "00:00", "甄試", "fa-user-check"],
        ["特殊選才", "登記就讀志願序", "115/2/4", "00:00", "志願", "fa-tasks"],
        ["特殊選才", "放榜", "115/2/11", "12:00", "結果", "fa-clipboard-check"],
        ["特殊選才", "報到截止", "115/3/3", "17:00", "截止", "fa-stopwatch"],
        ["科技繁星", "報名", "115/3/11", "00:00", "報名", "fa-edit"],
        ["科技繁星", "選填志願", "115/4/22", "00:00", "志願", "fa-tasks"],
        ["科技繁星", "放榜", "115/5/5", "12:00", "結果", "fa-clipboard-check"],
        ["科技繁星", "放棄截止", "115/5/12", "17:00", "截止", "fa-stopwatch"],
        ["技優保送", "報名", "115/3/4", "00:00", "報名", "fa-edit"],
        ["技優保送", "選填志願", "115/3/9", "00:00", "志願", "fa-tasks"],
        ["技優保送", "放榜", "115/3/17", "12:00", "結果", "fa-clipboard-check"],
        ["技優保送", "報到截止", "115/3/25", "17:00", "截止", "fa-stopwatch"],
        ["技優甄審", "資格審查登錄", "115/4/29", "00:00", "報名", "fa-edit"],
        ["技優甄審", "報名", "115/5/18", "00:00", "報名", "fa-edit"],
        ["技優甄審", "網路上傳(或勾選)備審資料", "115/6/4", "00:00", "資料", "fa-file-upload"],
        ["技優甄審", "指定項目甄審", "115/6/12", "00:00", "甄試", "fa-user-check"],
        ["技優甄審", "登記就讀志願序", "115/7/1", "00:00", "志願", "fa-tasks"],
        ["技優甄審", "放榜", "115/7/7", "12:00", "結果", "fa-clipboard-check"],
        ["技優甄審", "報到截止", "115/7/15", "17:00", "截止", "fa-stopwatch"],
        ["統一入學測驗", "報名", "114/12/6", "00:00", "報名", "fa-edit"],
        ["統一入學測驗", "寄發准考證", "115/3/19", "12:00", "准考證", "fa-id-card"],
        ["統一入學測驗", "統測", "115/4/26", "08:30", "考試", "fa-pen"],
        ["統一入學測驗", "寄發成績單", "115/5/15", "14:00", "成績", "fa-chart-bar"],
        ["統一入學測驗", "公告成績複查結果", "115/5/23", "12:00", "結果", "fa-clipboard-check"],
        ["甄選入學", "資格審查登錄", "115/4/16", "00:00", "報名", "fa-edit"],
        ["甄選入學", "應屆生查詢第6學期修課紀錄", "115/5/14", "00:00", "資料", "fa-file-alt"],
        ["甄選入學", "報名", "115/5/15", "00:00", "報名", "fa-edit"],
        ["甄選入學", "網路上傳(或勾選)備審資料", "115/6/5", "00:00", "資料", "fa-file-upload"],
        ["甄選入學", "二階甄試", "115/6/13", "00:00", "甄試", "fa-user-check"],
        ["甄選入學", "登記就讀志願序", "115/7/8", "00:00", "志願", "fa-tasks"],
        ["甄選入學", "放榜", "115/7/14", "12:00", "結果", "fa-clipboard-check"],
        ["甄選入學", "報到", "115/7/16", "00:00", "報到", "fa-check-circle"],
        ["聯合登記分發", "資格審查登錄", "115/5/4", "00:00", "報名", "fa-edit"],
        ["聯合登記分發", "報名", "115/7/14", "00:00", "報名", "fa-edit"],
        ["聯合登記分發", "公告實際招生名額", "115/7/27", "12:00", "名額", "fa-list-ol"],
        ["聯合登記分發", "選填志願", "115/7/28", "00:00", "志願", "fa-tasks"],
        ["聯合登記分發", "放榜", "115/8/6", "12:00", "結果", "fa-clipboard-check"],
        ["申請入學", "學測", "115/1/17", "08:30", "考試", "fa-pen"],
        ["申請入學", "報名", "115/3/19", "00:00", "報名", "fa-edit"],
        ["申請入學", "網路上傳(或勾選)備審資料", "115/4/30", "00:00", "資料", "fa-file-upload"],
        ["申請入學", "應屆生查詢第6學期修課紀錄", "115/5/11", "00:00", "資料", "fa-file-alt"],
        ["申請入學", "二階複試", "115/5/14", "00:00", "甄試", "fa-user-check"],
        ["申請入學", "各校公告正備取生名單", "115/5/29", "12:00", "結果", "fa-clipboard-check"],
        ["申請入學", "正取報到截止", "115/6/12", "17:00", "截止", "fa-stopwatch"],
        ["申請入學", "備取遞補截止", "115/6/14", "17:00", "截止", "fa-stopwatch"]
      ];
      
      // 找出並顯示最近的未來活動
      function findUpcomingEvents() {
        // 獲取當前日期
        const now = new Date();
        
        // 過濾未來事件並按日期排序
        const futureEvents = allEvents
          .map(event => {
            const [path, name, dateStr, timeStr, tag, icon] = event;
            const eventDate = parseROCDate(dateStr, timeStr);
            return { 
              path, 
              name, 
              date: eventDate, 
              dateStr, 
              timeStr, 
              tag, 
              icon,
              diffDays: Math.ceil((eventDate - now) / (1000 * 60 * 60 * 24)),
              diffMs: eventDate - now
            };
          })
          .filter(event => event.diffMs > 0)
          .sort((a, b) => a.date - b.date);
        
        return futureEvents.slice(0, 2); // 返回最近的兩個事件
      }
      
      // 生成倒數計時器HTML
      function generateCountdownHTML(event, index) {
        // 轉換民國年為顯示格式
        const dateParts = event.dateStr.split('/');
        const formattedDate = `${dateParts[0]}年${dateParts[1]}月${dateParts[2]}日 ${event.timeStr}`;
        
        return `
          <div class="countdown-box" id="countdown-${index}">
            <div class="countdown-label">
              <i class="fas ${event.icon}"></i>
              <span>${event.path} - ${event.name}</span>
            </div>
            <div class="countdown-date">${formattedDate}</div>
            <div class="countdown-timer-new" data-date="${event.dateStr}" data-time="${event.timeStr}">
              <div class="timer-block">
                <div class="time-value days">00</div>
                <div class="time-label">天</div>
              </div>
              <div class="timer-separator">:</div>
              <div class="timer-block">
                <div class="time-value hours">00</div>
                <div class="time-label">時</div>
              </div>
              <div class="timer-separator">:</div>
              <div class="timer-block">
                <div class="time-value minutes">00</div>
                <div class="time-label">分</div>
              </div>
              <div class="timer-separator">:</div>
              <div class="timer-block">
                <div class="time-value seconds">00</div>
                <div class="time-label">秒</div>
              </div>
            </div>
            <div class="countdown-progress">
              <div class="progress-bar">
                <div class="progress-fill"></div>
              </div>
            </div>
          </div>
        `;
      }
      
      // 動態生成倒數計時器
      function generateDynamicCountdowns() {
        const countdownGrid = document.getElementById('dynamic-countdown-grid');
        if (!countdownGrid) return;
        
        // 獲取最近的兩個事件
        const upcomingEvents = findUpcomingEvents();
        
        // 清空容器
        countdownGrid.innerHTML = '';
        
        // 生成倒數計時器
        upcomingEvents.forEach((event, index) => {
          countdownGrid.innerHTML += generateCountdownHTML(event, index);
        });
        
        // 如果沒有未來事件，顯示提示訊息
        if (upcomingEvents.length === 0) {
          countdownGrid.innerHTML = `
            <div class="no-events-message">
              <i class="fas fa-calendar-check"></i>
              <p>所有重要時程已結束</p>
            </div>
          `;
        }
      }
      
      // 添加「沒有未來事件」樣式和新選擇管道樣式
      document.addEventListener('DOMContentLoaded', function() {
        // 將樣式添加到頭部
        const styleElement = document.createElement('style');
        styleElement.textContent = `
          .no-events-message {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 2rem;
            text-align: center;
            background-color: #f8f9fa;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            width: 100%;
            margin: 1rem 0;
          }
          
          .no-events-message i {
            font-size: 3rem;
            color: #4361ee;
            margin-bottom: 1rem;
          }
          
          .no-events-message p {
            font-size: 1.2rem;
            color: #495057;
            font-weight: 500;
          }
          
          /* 全新的入學管道選擇器樣式 */
          .path-selector-container {
            margin-bottom: 1.5rem;
            padding: 1.5rem;
            border-radius: 12px;
            background-color: #f8faff;
            box-shadow: 0 4px 12px rgba(67, 97, 238, 0.08);
          }
          
          .path-selector-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: #2d3748;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
          }
          
          .path-selector-title i {
            color: #4361ee;
          }
          
          .path-selector {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 10px;
          }
          
          @media (max-width: 576px) {
            .path-selector {
              grid-template-columns: repeat(2, 1fr);
            }
          }
          
          .path-card {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 1rem 0.5rem;
            border-radius: 8px;
            background-color: white;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
            transition: all 0.2s ease-in-out;
            cursor: pointer;
            position: relative;
            overflow: hidden;
            height: 100%;
            text-align: center;
          }
          
          .path-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.1);
          }
          
          .path-card.active {
            background-color: #4361ee;
            color: white;
          }
          
          .path-card.active i {
            color: white;
          }
          
          .path-card.active .path-name {
            color: white;
          }
          
          .path-card.active::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background-color: rgba(255, 255, 255, 0.5);
          }
          
          .path-card.inactive-path {
            opacity: 0.7;
            background-color: #f5f5f5;
          }
          
          .path-card.inactive-path:hover {
            opacity: 0.9;
            background-color: #eeeeee;
          }
          
          .path-card.inactive-path::before {
            content: '已結束';
            position: absolute;
            top: 0.25rem;
            right: 0.25rem;
            font-size: 0.6rem;
            padding: 2px 4px;
            background-color: rgba(156, 163, 175, 0.8);
            color: white;
            border-radius: 4px;
            font-weight: 500;
          }
          
          .path-card.inactive-path.active {
            background-color: #9ca3af;
          }
          
          .path-icon {
            font-size: 1.8rem;
            margin-bottom: 0.5rem;
            color: #4361ee;
            transition: all 0.2s ease;
          }
          
          .path-name {
            font-size: 0.9rem;
            font-weight: 500;
            color: #2d3748;
          }
          
          .path-badge {
            position: absolute;
            top: 0;
            right: 0;
            background-color: #fbbf24;
            color: #7c2d12;
            font-size: 0.6rem;
            font-weight: 600;
            padding: 2px 5px;
            border-radius: 0 8px 0 8px;
          }
          
          .path-progress {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background-color: #e5e7eb;
          }
          
          .path-progress-fill {
            height: 100%;
            background-color: #4361ee;
            transition: width 0.5s ease;
          }
          
          /* 隱藏舊的頁籤標頭 */
          .tab-header {
            display: none;
          }
        `;
        document.head.appendChild(styleElement);
      });
      
      // 管道信息配置
      const pathConfigs = [
        { id: 'tab1', name: '特殊選才', icon: 'fa-user-graduate', key: '特殊選才' },
        { id: 'tab2', name: '科技繁星', icon: 'fa-star', key: '科技繁星' },
        { id: 'tab3', name: '技優保送', icon: 'fa-award', key: '技優保送' },
        { id: 'tab4', name: '技優甄審', icon: 'fa-medal', key: '技優甄審' },
        { id: 'tab5', name: '統一入學測驗', icon: 'fa-pen', key: '統一入學測驗' },
        { id: 'tab6', name: '甄選入學', icon: 'fa-check-circle', key: '甄選入學' },
        { id: 'tab7', name: '聯合登記分發', icon: 'fa-list-alt', key: '聯合登記分發' },
        { id: 'tab8', name: '申請入學', icon: 'fa-file-alt', key: '申請入學' },
        { id: 'tab9', name: '管道比較', icon: 'fa-table', key: null } // 比較表沒有特定管道
      ];
      
      // 檢查入學管道是否已結束
      function isPathEnded(pathKey) {
        if (!pathKey) return false; // 管道比較頁籤永不過期
        
        const now = new Date();
        // 獲取特定管道的所有事件
        const pathEvents = allEvents
          .filter(event => event[0] === pathKey)
          .map(event => {
            const dateStr = event[2];
            const timeStr = event[3];
            const eventDate = parseROCEndDate(dateStr, timeStr);
            return { date: eventDate };
          });
        
        // 如果該管道沒有事件，則視為未結束
        if (pathEvents.length === 0) return false;
        
        // 檢查是否所有事件都已結束
        return pathEvents.every(event => event.date < now);
      }
      
      // 計算管道進度
      function calculatePathProgress(pathKey) {
        if (!pathKey) return 100; // 管道比較頁籤顯示100%
        
        const now = new Date();
        // 獲取特定管道的所有事件
        const pathEvents = allEvents
          .filter(event => event[0] === pathKey)
          .map(event => {
            const dateStr = event[2];
            const timeStr = event[3];
            const eventDate = parseROCDate(dateStr, timeStr);
            return { date: eventDate };
          })
          .sort((a, b) => a.date - b.date);
        
        // 如果該管道沒有事件，則視為完成
        if (pathEvents.length === 0) return 100;
        
        // 檢查所有事件進度
        const firstEventDate = pathEvents[0].date;
        const lastEventDate = pathEvents[pathEvents.length - 1].date;
        const totalDuration = lastEventDate - firstEventDate;
        
        // 如果全部事件已過期
        if (now > lastEventDate) return 100;
        
        // 如果第一個事件還未開始
        if (now < firstEventDate) return 0;
        
        // 已經進行的時間佔比
        const elapsedTime = now - firstEventDate;
        const progressPercent = (elapsedTime / totalDuration) * 100;
        return Math.min(Math.max(progressPercent, 0), 100);
      }
      
      // 檢查管道是否有即將到來的事件 (7天內)
      function hasUpcomingEvents(pathKey, daysThreshold = 7) {
        if (!pathKey) return false;
        
        const now = new Date();
        const futureThreshold = new Date(now);
        futureThreshold.setDate(futureThreshold.getDate() + daysThreshold);
        
        // 獲取特定管道的所有事件
        return allEvents
          .filter(event => event[0] === pathKey)
          .some(event => {
            const dateStr = event[2];
            const timeStr = event[3];
            const eventDate = parseROCDate(dateStr, timeStr);
            return eventDate > now && eventDate <= futureThreshold;
          });
      }
      
      // 生成動態管道選擇器
      function generateDynamicTabs() {
        const pathSelector = document.getElementById('dynamic-path-selector');
        if (!pathSelector) return;
        
        // 清空選擇器
        pathSelector.innerHTML = '';
        
        // 將管道分為活躍和已結束
        const activePaths = [];
        const inactivePaths = [];
        
        pathConfigs.forEach(config => {
          if (isPathEnded(config.key)) {
            inactivePaths.push(config);
          } else {
            activePaths.push(config);
          }
        });
        
        // 生成管道卡片 (活躍的管道在前，已結束的管道在後)
        const allPaths = [...activePaths, ...inactivePaths];
        let activeCardIndex = 0; // 預設選擇第一個卡片
        
        allPaths.forEach((config, index) => {
          const isInactive = inactivePaths.includes(config);
          const hasUpcoming = hasUpcomingEvents(config.key);
          const progress = calculatePathProgress(config.key);
          
          const card = document.createElement('div');
          card.className = `path-card ${isInactive ? 'inactive-path' : ''} ${index === activeCardIndex ? 'active' : ''}`;
          card.setAttribute('data-tab', config.id);
          card.setAttribute('onclick', `openTab(event, '${config.id}')`);
          
          // 即將到來的事件標記
          let badgeHTML = '';
          if (hasUpcoming && !isInactive) {
            badgeHTML = `<span class="path-badge">近期</span>`;
          }
          
          // 進度條
          const progressHTML = `
            <div class="path-progress">
              <div class="path-progress-fill" style="width: ${progress}%"></div>
            </div>
          `;
          
          card.innerHTML = `
            ${badgeHTML}
            <div class="path-icon">
              <i class="fas ${config.icon}"></i>
            </div>
            <div class="path-name">${config.name}</div>
            ${progressHTML}
          `;
          
          if (isInactive) {
            card.setAttribute('title', '此入學管道所有時程已結束');
          }
          
          pathSelector.appendChild(card);
        });
        
        // 修改openTab函數，支持path-card的點擊
        const originalOpenTab = window.openTab;
        window.openTab = function(evt, tabId) {
          // 移除所有卡片的active類
          document.querySelectorAll('.path-card').forEach(card => {
            card.classList.remove('active');
          });
          
          // 如果是卡片點擊，添加active類
          if (evt && evt.currentTarget && evt.currentTarget.classList.contains('path-card')) {
            evt.currentTarget.classList.add('active');
          } else if (evt) {
            // 如果是頁籤點擊，找到對應的卡片添加active類
            const correspondingCard = document.querySelector(`.path-card[data-tab="${tabId}"]`);
            if (correspondingCard) {
              correspondingCard.classList.add('active');
            }
          }
          
          // 調用原始的openTab函數
          originalOpenTab(evt, tabId);
        };
        
        // 初始顯示第一個頁籤內容
        if (allPaths.length > 0) {
          const firstTabId = allPaths[activeCardIndex].id;
          const firstCard = document.querySelector(`.path-card[data-tab="${firstTabId}"]`);
          if (firstCard) {
            openTab({ currentTarget: firstCard }, firstTabId);
          }
        }
        
        // 保存原始的openTab函數
        window.originalOpenTab = originalOpenTab;
      }
      
      // 不再使用入學管道分類選單
      function updateSideMenu() {
        // 處理是否有入學管道選單項目 - 如果有就移除
        const menuCategories = document.querySelectorAll('.menu-category');
        menuCategories.forEach(category => {
          if (category.textContent.includes('入學管道')) {
            // 移除該分類標題下的所有相關項目
            let nextElement = category.nextElementSibling;
            const itemsToRemove = [category]; // 也移除分類標題本身
            
            while (nextElement && !nextElement.classList.contains('menu-category')) {
              itemsToRemove.push(nextElement);
              nextElement = nextElement.nextElementSibling;
            }
            
            itemsToRemove.forEach(item => item.remove());
          }
        });
        
        // 移除相關樣式
        const oldStyle = document.getElementById('menu-path-styles');
        if (oldStyle) {
          oldStyle.remove();
        }
      }
      
      // 新版倒數計時功能
      function updateCountdowns() {
        // 處理新版倒數計時
        const newCountdownTimers = document.querySelectorAll('.countdown-timer-new');
        
        newCountdownTimers.forEach(timer => {
          const targetDateStr = timer.getAttribute('data-date');
          const targetTimeStr = timer.getAttribute('data-time') || '00:00';
          const targetDate = parseROCDate(targetDateStr, targetTimeStr);
          
          // 找到父元素 (countdown-box)
          const countdownBox = timer.closest('.countdown-box');
          
          // 計算剩餘時間
          const now = new Date();
          const diff = targetDate - now;
          
          // 計算開始日期（假設事件提前3個月開始倒數）
          const startDate = new Date(targetDate);
          startDate.setMonth(startDate.getMonth() - 3);
          
          // 計算總時間範圍和已經過去的時間
          const totalTimeRange = targetDate - startDate;
          const elapsedTime = now - startDate;
          
          // 計算進度百分比
          let progressPercent = (elapsedTime / totalTimeRange) * 100;
          progressPercent = Math.max(0, Math.min(100, progressPercent)); // 限制在0-100之間
          
          // 更新進度條
          const progressFill = countdownBox.querySelector('.progress-fill');
          if (progressFill) {
            progressFill.style.width = `${progressPercent}%`;
          }
          
          // 如果日期已過，顯示已過期
          if (diff < 0) {
            timer.querySelectorAll('.time-value').forEach(value => {
              value.textContent = '00';
            });
            
            countdownBox.classList.add('expired');
            return;
          }
          
          // 如果在7天內，添加即將到來的類別
          if (diff < 7 * 24 * 60 * 60 * 1000) {
            countdownBox.classList.add('coming-soon');
          } else {
            countdownBox.classList.remove('coming-soon');
          }
          
          // 計算天數、小時、分鐘、秒數
          const days = Math.floor(diff / (1000 * 60 * 60 * 24));
          const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
          const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
          const seconds = Math.floor((diff % (1000 * 60)) / 1000);
          
          // 更新顯示
          const daysElement = timer.querySelector('.days');
          const hoursElement = timer.querySelector('.hours');
          const minutesElement = timer.querySelector('.minutes');
          const secondsElement = timer.querySelector('.seconds');
          
          if (daysElement) daysElement.textContent = days.toString().padStart(2, '0');
          if (hoursElement) hoursElement.textContent = hours.toString().padStart(2, '0');
          if (minutesElement) minutesElement.textContent = minutes.toString().padStart(2, '0');
          if (secondsElement) secondsElement.textContent = seconds.toString().padStart(2, '0');
        });
      }
      
      // 網頁載入完成後初始化所有功能
      document.addEventListener('DOMContentLoaded', function() {
        // 初始化動態頁籤、倒數計時和最近事件
        generateDynamicTabs();
        updateSideMenu();
        generateDynamicCountdowns();
        updateCountdowns();
        findUpcomingEvent();
      });
      
      // 每秒更新倒數計時，每小時更新所有動態內容
      setInterval(updateCountdowns, 1000);
      setInterval(() => {
        generateDynamicTabs();
        updateSideMenu();
        generateDynamicCountdowns();
        findUpcomingEvent();
      }, 60 * 60 * 1000);

      // 分享功能
      function shareOnFacebook() {
        const url = encodeURIComponent(window.location.href);
        const title = encodeURIComponent(document.title);
        window.open(`https://www.facebook.com/sharer/sharer.php?u=${url}&t=${title}`, '_blank');
      }
      
      function shareOnLine() {
        const url = encodeURIComponent(window.location.href);
        const title = encodeURIComponent(document.title);
        window.open(`https://social-plugins.line.me/lineit/share?url=${url}&text=${title}`, '_blank');
      }
      
      function shareByEmail() {
        const subject = encodeURIComponent(document.title);
        const body = encodeURIComponent(`我想與你分享這個有用的資訊：\n${window.location.href}`);
        window.open(`mailto:?subject=${subject}&body=${body}`);
      }
      
      function copyShareLink() {
        navigator.clipboard.writeText(window.location.href).then(() => {
          const copyMessage = document.getElementById('copy-message');
          copyMessage.classList.add('show');
          setTimeout(() => {
            copyMessage.classList.remove('show');
          }, 2000);
        });
      }

      // 顯示QR Code模態視窗
      function showQRCode() {
        const url = window.location.href;
        const qrcodeDisplay = document.getElementById('qrcode-display');
        qrcodeDisplay.innerHTML = '';
        
        // 使用qrcode-generator庫生成QR Code
        const typeNumber = 0;
        const errorCorrectionLevel = 'L';
        const qr = qrcode(typeNumber, errorCorrectionLevel);
        qr.addData(url);
        qr.make();
        
        // 將生成的QR Code插入到顯示區域
        const qrImg = qr.createImgTag(4);
        qrcodeDisplay.innerHTML = qrImg;
        
        // 顯示模態視窗
        document.getElementById('qrcode-modal').classList.add('show');
      }

      // 關閉QR Code模態視窗
      function closeQRModal() {
        document.getElementById('qrcode-modal').classList.remove('show');
      }

      // 點擊模態視窗外部時關閉
      document.getElementById('qrcode-modal').addEventListener('click', function(event) {
        if (event.target === this) {
          closeQRModal();
        }
      });

      // 按ESC鍵關閉模態視窗
      document.addEventListener('keydown', function(event) {
        if (event.key === 'Escape' && document.getElementById('qrcode-modal').classList.contains('show')) {
          closeQRModal();
        }
      });

      // 禁止模態視窗內容部分的點擊事件冒泡
      document.querySelector('.modal-content').addEventListener('click', function(event) {
        event.stopPropagation();
      });

      // 找出並顯示最近即將進行的日程
      function findUpcomingEvent() {
        // 獲取最近的未來事件
        const futureEvents = findUpcomingEvents();
        
        // 如果有未來事件，顯示最近的一個
        if (futureEvents.length > 0) {
          const nextEvent = futureEvents[0];
          
          // 更新顯示
          document.getElementById('event-path').textContent = nextEvent.path;
          document.getElementById('event-name').textContent = nextEvent.name;
          
          // 轉換民國年為西元年
          const dateROC = nextEvent.dateStr.split('/');
          const yearROC = parseInt(dateROC[0]);
          const dateStr = `${yearROC}年${dateROC[1]}月${dateROC[2]}日`;
          document.getElementById('event-date').textContent = `${dateStr} ${nextEvent.timeStr}`;
          
          // 更新剩餘天數
          document.getElementById('event-remaining-days').textContent = `剩餘 ${nextEvent.diffDays} 天`;
          
          // 設置事件圖標
          document.querySelector('.event-icon i').className = `fas ${nextEvent.icon}`;
          
          // 根據天數設置不同的狀態樣式
          const statusLabel = document.querySelector('.status-label');
          if (nextEvent.diffDays <= 3) {
            statusLabel.textContent = '緊急';
            statusLabel.classList.add('urgent');
          } else if (nextEvent.diffDays <= 7) {
            statusLabel.textContent = '即將到來';
            statusLabel.classList.add('coming-soon');
          }
          
          // 顯示卡片
          document.getElementById('next-event').classList.add('show');
        } else {
          // 如果沒有未來事件，隱藏卡片
          document.getElementById('next-event').style.display = 'none';
          document.querySelector('.upcoming-event-container').style.display = 'none';
        }
      }
      
      // 添加到行事曆功能
      function addToCalendar() {
        const eventPath = document.getElementById('event-path').textContent;
        const eventName = document.getElementById('event-name').textContent;
        const eventDateText = document.getElementById('event-date').textContent;
        
        // 解析日期時間
        const dateMatch = eventDateText.match(/(\d+)年(\d+)月(\d+)日\s+(\d+):(\d+)/);
        if (dateMatch) {
          const [_, year, month, day, hour, minute] = dateMatch;
          
          // 創建Google Calendar連結
          const eventTitle = `${eventPath} - ${eventName}`;
          const startDate = `${parseInt(year) + 1911}-${month.padStart(2, '0')}-${day.padStart(2, '0')}T${hour.padStart(2, '0')}:${minute.padStart(2, '0')}:00`;
          const endDate = `${parseInt(year) + 1911}-${month.padStart(2, '0')}-${day.padStart(2, '0')}T${(parseInt(hour) + 1).toString().padStart(2, '0')}:${minute.padStart(2, '0')}:00`;
          
          const googleCalUrl = `https://calendar.google.com/calendar/render?action=TEMPLATE&text=${encodeURIComponent(eventTitle)}&dates=${startDate.replace(/[-:]/g, '')}/${endDate.replace(/[-:]/g, '')}&details=${encodeURIComponent('四技二專招生重要時程')}`;
          
          window.open(googleCalUrl, '_blank');
        }
      }
      
      // 設定提醒功能
      function setReminder() {
        const eventPath = document.getElementById('event-path').textContent;
        const eventName = document.getElementById('event-name').textContent;
        const remainingDays = document.getElementById('event-remaining-days').textContent;
        
        // 如果支援通知API，請求權限
        if ('Notification' in window) {
          Notification.requestPermission().then(permission => {
            if (permission === 'granted') {
              alert(`已設定${eventPath} - ${eventName}的提醒，將在事件前一天通知您。`);
              // 這裡實際上需要實現後端存儲提醒的功能
              // 或使用localStorage等方式在用戶設備上存儲
            } else {
              alert('需要通知權限才能設定提醒');
            }
          });
        } else {
          // 不支援通知API的回退選項
          const confirmReminder = confirm(`是否要在${eventPath} - ${eventName}前一天收到提醒？\n(將通過瀏覽器通知提醒)`);
          if (confirmReminder) {
            alert('已設定提醒，請在事件前保持瀏覽器開啟以接收通知。');
          }
        }
      }
      
      // 初始化時查找並顯示最近的事件
      findUpcomingEvent();
      
      // 添加卡片動畫效果
      setTimeout(() => {
        const upcomingCard = document.getElementById('next-event');
        if (upcomingCard) {
          upcomingCard.classList.add('show');
        }
      }, 500);
      
      // 每小時更新一次事件顯示
      setInterval(findUpcomingEvent, 60 * 60 * 1000);
    </script>
    <script src="calendar-export.js"></script>
    
    <!-- 表格水平滾動支援 -->
    <script>
      document.addEventListener('DOMContentLoaded', function() {
        // 表格滾動
        const tableContainer = document.querySelector('.table-container');
        if (tableContainer) {
          setupHorizontalScroll(tableContainer, '左右滑動查看完整表格');
        }
        
        // 時程分布圖滾動
        const compareChart = document.querySelector('.compare-chart');
        if (compareChart) {
          setupHorizontalScroll(compareChart, '左右滑動查看完整時程圖');
        }
        
        // 設置水平滾動功能
        function setupHorizontalScroll(container, message) {
          // 檢測是否為觸控裝置
          const isTouchDevice = 'ontouchstart' in window || navigator.maxTouchPoints > 0;
          
          if (isTouchDevice) {
            // 添加視覺指示
            let scrollIndicator = document.createElement('div');
            scrollIndicator.className = 'scroll-indicator';
            scrollIndicator.innerHTML = '<i class="fas fa-arrows-alt-h"></i>';
            
            // 設置指示訊息
            scrollIndicator.setAttribute('data-message', message);
            container.parentNode.insertBefore(scrollIndicator, container);
            
            // 觸控滑動事件
            let startX, startScrollLeft;
            
            container.addEventListener('touchstart', function(e) {
              startX = e.touches[0].pageX;
              startScrollLeft = container.scrollLeft;
            }, { passive: true });
            
            container.addEventListener('touchmove', function(e) {
              if (!startX) return;
              
              const x = e.touches[0].pageX;
              const distance = startX - x;
              container.scrollLeft = startScrollLeft + distance;
            }, { passive: true });
            
            container.addEventListener('touchend', function() {
              startX = null;
            });
            
            // 滾動後隱藏指示器
            container.addEventListener('scroll', function() {
              if (scrollIndicator) {
                scrollIndicator.style.opacity = '0';
                setTimeout(function() {
                  scrollIndicator.remove();
                  scrollIndicator = null;
                }, 300);
              }
            });
          }
        }
      });
    </script>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-H9X7EC127P"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-H9X7EC127P');
</script>
  </body>
</html> 
