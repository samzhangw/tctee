<!DOCTYPE html>
<html lang="zh-TW">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
    <meta name="theme-color" content="#1677ff" />
    <meta name="description" content="114年度四技二專統測重要時程" />
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>114年四技二專統測重要時程</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  </head>
  <body>
    <div class="app-container">
      <header class="app-header">
        <h1><i class="fas fa-calendar-alt"></i> 114年四技二專統測重要時程</h1>
        <p class="export-info">使用"匯出"按鈕可將時程匯出至 Google 日曆、Outlook 等行事曆應用。</p>
        <button id="menu-toggle" class="menu-toggle">
          <i class="fas fa-bars"></i>
        </button>
        <div id="side-menu" class="side-menu">
          <div class="menu-header">
            <h3><i class="fas fa-graduation-cap"></i> 選單導航</h3>
            <button id="menu-close" class="menu-close">
              <i class="fas fa-times"></i>
            </button>
          </div>
          <ul class="menu-list">
            <li><a href="#" class="menu-item"><i class="fas fa-home"></i> 首頁</a></li>
            <li><a href="#" class="menu-item"><i class="fas fa-calendar-check"></i> 完整時程表</a></li>
            <li><a href="#" class="menu-item"><i class="fas fa-book"></i> 招生簡章</a></li>
            <li><a href="#" class="menu-item"><i class="fas fa-file-alt"></i> 歷年試題</a></li>
            <li><a href="#" class="menu-item"><i class="fas fa-university"></i> 技專校院導覽</a></li>
            <li><a href="#" class="menu-item"><i class="fas fa-chart-bar"></i> 落點分析</a></li>
            <li><a href="#" class="menu-item"><i class="fas fa-question-circle"></i> 常見問題</a></li>
            <li><a href="#" class="menu-item"><i class="fas fa-phone-alt"></i> 聯絡我們</a></li>
          </ul>
          <div class="menu-footer">
            <button onclick="exportAllEvents()" class="menu-export-btn">
              <i class="fas fa-calendar-plus"></i> 匯出全部時程
            </button>
          </div>
        </div>
        <div id="overlay" class="overlay"></div>
      </header>
      
      <!-- 搜尋框 -->
      <div class="search-container">
        <div class="search-input-container">
          <i class="fas fa-search search-icon"></i>
          <input type="text" id="search-input" class="search-input" placeholder="搜尋重要時程..." />
          <button id="clear-search" class="clear-search">
            <i class="fas fa-times"></i>
          </button>
        </div>
      </div>

      <!-- 倒數計時區塊 -->
      <div class="countdown-container">
        <div class="countdown-title">
          <i class="fas fa-hourglass-half"></i> 重要時程精確倒數
        </div>
        <div class="countdown-cards">
          <div class="countdown-card" id="countdown-exam">
            <div class="countdown-event">距離四技二專統測開始還有</div>
            <div class="countdown-timer" data-date="114/4/26" data-time="08:30">計算中...</div>
          </div>
          <div class="countdown-card" id="countdown-results">
            <div class="countdown-event">距離四技二專成績公布還有</div>
            <div class="countdown-timer" data-date="114/5/15" data-time="14:00">計算中...</div>
          </div>
        </div>
      </div>
      
      <!-- 全新倒數計時區塊 -->
      <div class="countdown-container">
        <div class="countdown-header">
          <i class="fas fa-hourglass-half"></i>
          <h2>重要時程倒數</h2>
        </div>
        
        <div class="countdown-grid">
          <!-- 統測倒數 -->
          <div class="countdown-box" id="countdown-exam">
            <div class="countdown-label">
              <i class="fas fa-pen"></i>
              <span>四技二專統測</span>
            </div>
            <div class="countdown-date">114年4月26日 08:30</div>
            <div class="countdown-timer-new" data-date="114/4/26" data-time="08:30">
              <div class="timer-block">
                <div class="time-value days">00</div>
                <div class="time-label">天</div>
              </div>
              <div class="timer-separator">:</div>
              <div class="timer-block">
                <div class="time-value hours">00</div>
                <div class="time-label">時</div>
              </div>
              <div class="timer-separator">:</div>
              <div class="timer-block">
                <div class="time-value minutes">00</div>
                <div class="time-label">分</div>
              </div>
              <div class="timer-separator">:</div>
              <div class="timer-block">
                <div class="time-value seconds">00</div>
                <div class="time-label">秒</div>
              </div>
            </div>
            <div class="countdown-progress">
              <div class="progress-bar">
                <div class="progress-fill"></div>
              </div>
            </div>
          </div>
          
          <!-- 成績公布倒數 -->
          <div class="countdown-box" id="countdown-results">
            <div class="countdown-label">
              <i class="fas fa-clipboard-check"></i>
              <span>四技二專成績公布</span>
            </div>
            <div class="countdown-date">114年5月15日 14:00</div>
            <div class="countdown-timer-new" data-date="114/5/15" data-time="14:00">
              <div class="timer-block">
                <div class="time-value days">00</div>
                <div class="time-label">天</div>
              </div>
              <div class="timer-separator">:</div>
              <div class="timer-block">
                <div class="time-value hours">00</div>
                <div class="time-label">時</div>
              </div>
              <div class="timer-separator">:</div>
              <div class="timer-block">
                <div class="time-value minutes">00</div>
                <div class="time-label">分</div>
              </div>
              <div class="timer-separator">:</div>
              <div class="timer-block">
                <div class="time-value seconds">00</div>
                <div class="time-label">秒</div>
              </div>
            </div>
            <div class="countdown-progress">
              <div class="progress-bar">
                <div class="progress-fill"></div>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <main class="app-main">
        <div class="tabs">
          <div class="tab-header">
            <button class="tab-button active" onclick="openTab(event, 'tab1')"><i class="fas fa-user-graduate"></i> 特殊選才</button>
            <button class="tab-button" onclick="openTab(event, 'tab2')"><i class="fas fa-star"></i> 科技繁星</button>
            <button class="tab-button" onclick="openTab(event, 'tab3')"><i class="fas fa-award"></i> 技優保送</button>
            <button class="tab-button" onclick="openTab(event, 'tab4')"><i class="fas fa-medal"></i> 技優甄審</button>
            <button class="tab-button" onclick="openTab(event, 'tab5')"><i class="fas fa-pen"></i> 統一入學測驗</button>
            <button class="tab-button" onclick="openTab(event, 'tab6')"><i class="fas fa-check-circle"></i> 甄選入學</button>
            <button class="tab-button" onclick="openTab(event, 'tab7')"><i class="fas fa-list-alt"></i> 聯合登記分發</button>
            <button class="tab-button" onclick="openTab(event, 'tab8')"><i class="fas fa-file-alt"></i> 申請入學</button>
          </div>
          
          <!-- 特殊選才 -->
          <div id="tab1" class="tab-content active">
            <div class="timeline-container">
              <h2><i class="fas fa-user-graduate"></i> 特殊選才</h2>
              <div class="description">
                <h3><i class="fas fa-info-circle"></i> 招收具特殊才能、不同教育資歷及青年儲蓄方案者</h3>
              </div>
              <div class="timeline">
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 113/12/16-20</div>
                    <div class="timeline-event">報名</div>
                  </div>
                </div>
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 114/2/4-9</div>
                    <div class="timeline-event">指定項目甄審</div>
                  </div>
                </div>
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 114/2/12-14</div>
                    <div class="timeline-event">登記就讀志願序</div>
                  </div>
                </div>
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 114/2/18</div>
                    <div class="timeline-event">放榜</div>
                  </div>
                </div>
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 114/3/4</div>
                    <div class="timeline-event">報到截止</div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          
          <!-- 科技繁星 -->
          <div id="tab2" class="tab-content">
            <div class="timeline-container">
              <h2><i class="fas fa-star"></i> 科技繁星</h2>
              <div class="description">
                <h3><i class="fas fa-info-circle"></i> 招收專業群科、綜高專門學程、校內推薦在校前30%應屆生</h3>
              </div>
              <div class="timeline">
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 114/3/12-19</div>
                    <div class="timeline-event">報名</div>
                  </div>
                </div>
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 114/4/24-30</div>
                    <div class="timeline-event">選填志願</div>
                  </div>
                </div>
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 114/5/6</div>
                    <div class="timeline-event">放榜</div>
                  </div>
                </div>
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 114/5/13</div>
                    <div class="timeline-event">放棄截止</div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          
          <!-- 技優保送 -->
          <div id="tab3" class="tab-content">
            <div class="timeline-container">
              <h2><i class="fas fa-award"></i> 技優保送</h2>
              <div class="description">
                <h3><i class="fas fa-info-circle"></i> 招收國際或全國技藝技能競賽前3名獲獎者或正備取國手</h3>
              </div>
              <div class="timeline">
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 114/2/17-20</div>
                    <div class="timeline-event">報名</div>
                  </div>
                </div>
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 114/3/10-12</div>
                    <div class="timeline-event">選填志願</div>
                  </div>
                </div>
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 114/3/18</div>
                    <div class="timeline-event">放榜</div>
                  </div>
                </div>
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 114/3/26</div>
                    <div class="timeline-event">報到截止</div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          
          <!-- 技優甄審 -->
          <div id="tab4" class="tab-content">
            <div class="timeline-container">
              <h2><i class="fas fa-medal"></i> 技優甄審</h2>
              <div class="description">
                <h3><i class="fas fa-info-circle"></i> 招收技藝技能競賽得獎、取得專技普考證書或乙級以上技術士證者</h3>
              </div>
              <div class="timeline">
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 114/4/29-5/6</div>
                    <div class="timeline-event">資格審查登錄</div>
                  </div>
                </div>
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 114/5/19-23</div>
                    <div class="timeline-event">報名</div>
                  </div>
                </div>
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 114/6/5-10</div>
                    <div class="timeline-event">網路上傳(或勾選)備審資料</div>
                  </div>
                </div>
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 114/6/13-22</div>
                    <div class="timeline-event">指定項目甄審</div>
                  </div>
                </div>
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 114/7/2-4</div>
                    <div class="timeline-event">登記就讀志願序</div>
                  </div>
                </div>
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 114/7/8</div>
                    <div class="timeline-event">放榜</div>
                  </div>
                </div>
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 114/7/16</div>
                    <div class="timeline-event">報到截止</div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          
          <!-- 統一入學測驗 -->
          <div id="tab5" class="tab-content">
            <div class="timeline-container">
              <h2><i class="fas fa-pen"></i> 統一入學測驗</h2>
              <div class="description">
                <h3><i class="fas fa-info-circle"></i> 四技二專統一入學測驗</h3>
              </div>
              <div class="timeline">
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 113/12/6-18</div>
                    <div class="timeline-event">報名</div>
                  </div>
                </div>
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 114/3/19</div>
                    <div class="timeline-event">寄發准考證</div>
                  </div>
                </div>
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 114/4/26-27</div>
                    <div class="timeline-event">統測</div>
                  </div>
                </div>
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 114/5/15</div>
                    <div class="timeline-event">寄發成績單</div>
                  </div>
                </div>
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 114/5/23</div>
                    <div class="timeline-event">公告成績複查結果</div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          
          <!-- 甄選入學 -->
          <div id="tab6" class="tab-content">
            <div class="timeline-container">
              <h2><i class="fas fa-check-circle"></i> 甄選入學</h2>
              <div class="description">
                <h3><i class="fas fa-info-circle"></i> 採計統測成績，招收專業群科、綜高專門學程、非應屆普通科或青年儲蓄方案者</h3>
              </div>
              <div class="timeline">
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 114/4/17-30</div>
                    <div class="timeline-event">資格審查登錄</div>
                  </div>
                </div>
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 114/5/15-19</div>
                    <div class="timeline-event">應屆生查詢第6學期修課紀錄</div>
                  </div>
                </div>
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 114/5/16-23</div>
                    <div class="timeline-event">報名</div>
                  </div>
                </div>
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 114/6/6-13</div>
                    <div class="timeline-event">網路上傳(或勾選)備審資料</div>
                  </div>
                </div>
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 114/6/14-29</div>
                    <div class="timeline-event">二階甄試</div>
                  </div>
                </div>
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 114/7/9-11</div>
                    <div class="timeline-event">登記就讀志願序</div>
                  </div>
                </div>
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 114/7/15</div>
                    <div class="timeline-event">放榜</div>
                  </div>
                </div>
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 114/7/17-21</div>
                    <div class="timeline-event">報到</div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          
          <!-- 聯合登記分發 -->
          <div id="tab7" class="tab-content">
            <div class="timeline-container">
              <h2><i class="fas fa-list-alt"></i> 聯合登記分發</h2>
              <div class="description">
                <h3><i class="fas fa-info-circle"></i> 採計統測成績，招收專業群科、綜合高中或非應屆普通科學力者</h3>
              </div>
              <div class="timeline">
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 114/5/5-6/4</div>
                    <div class="timeline-event">資格審查登錄</div>
                  </div>
                </div>
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 114/7/15-23</div>
                    <div class="timeline-event">報名</div>
                  </div>
                </div>
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 114/7/28</div>
                    <div class="timeline-event">公告實際招生名額</div>
                  </div>
                </div>
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 114/7/29-8/1</div>
                    <div class="timeline-event">選填志願</div>
                  </div>
                </div>
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 114/8/7</div>
                    <div class="timeline-event">放榜</div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          
          <!-- 申請入學 -->
          <div id="tab8" class="tab-content">
            <div class="timeline-container">
              <h2><i class="fas fa-file-alt"></i> 申請入學</h2>
              <div class="description">
                <h3><i class="fas fa-info-circle"></i> 採計學測成績，招收高中普通科或其他符合四技申請入學資格者</h3>
              </div>
              <div class="timeline">
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 114/1/18-20</div>
                    <div class="timeline-event">學測</div>
                  </div>
                </div>
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 114/3/17-21</div>
                    <div class="timeline-event">報名</div>
                  </div>
                </div>
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 114/5/1-7</div>
                    <div class="timeline-event">網路上傳(或勾選)備審資料</div>
                  </div>
                </div>
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 114/5/12-13</div>
                    <div class="timeline-event">應屆生查詢第6學期修課紀錄</div>
                  </div>
                </div>
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 114/5/15-27</div>
                    <div class="timeline-event">二階複試</div>
                  </div>
                </div>
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 114/6/2前</div>
                    <div class="timeline-event">各校公告正備取生名單</div>
                  </div>
                </div>
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 114/6/13</div>
                    <div class="timeline-event">正取報到截止</div>
                  </div>
                </div>
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <div class="timeline-card">
                    <div class="timeline-date"><i class="far fa-calendar"></i> 114/6/15</div>
                    <div class="timeline-event">備取遞補截止</div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </main>
      
      <!-- 分享區塊 -->
      <div class="share-container">
        <h3><i class="fas fa-share-alt"></i> 分享給同學</h3>
        <div class="share-buttons">
          <button class="share-button" onclick="shareOnFacebook()">
            <i class="fab fa-facebook-f"></i>
          </button>
          <button class="share-button" onclick="shareOnLine()">
            <i class="fab fa-line"></i>
          </button>
          <button class="share-button" onclick="shareByEmail()">
            <i class="fas fa-envelope"></i>
          </button>
          <button class="share-button" onclick="copyShareLink()">
            <i class="fas fa-link"></i>
          </button>
        </div>
        <div id="copy-message" class="copy-message">連結已複製！</div>
      </div>
      
      <footer class="app-footer">
        <p>© <span id="current-year"></span> 114年四技二專統測重要時程</p>
      </footer>
    </div>

    <!-- 浮動回到頂部按鈕 -->
    <div id="back-to-top" class="floating-button">
      <button aria-label="回到頂部">
        <i class="fas fa-arrow-up"></i>
      </button>
    </div>

    <!-- 手機版底部導航 -->
    <div class="mobile-nav">
      <button class="mobile-nav-btn" onclick="openTab(event, 'tab5')">
        <i class="fas fa-pen"></i>
        <span>統測</span>
      </button>
      <button class="mobile-nav-btn" onclick="document.getElementById('search-input').focus()">
        <i class="fas fa-search"></i>
        <span>搜尋</span>
      </button>
      <button class="mobile-nav-btn" onclick="document.getElementById('menu-toggle').click()">
        <i class="fas fa-bars"></i>
        <span>選單</span>
      </button>
      <button class="mobile-nav-btn" onclick="exportAllEvents()">
        <i class="fas fa-calendar-plus"></i>
        <span>匯出</span>
      </button>
    </div>

    <script>
      // 設置當前年份
      document.getElementById('current-year').textContent = new Date().getFullYear();
      
      // 頁籤切換功能
      function openTab(evt, tabId) {
        // 隱藏所有頁籤內容
        var tabContents = document.getElementsByClassName("tab-content");
        for (var i = 0; i < tabContents.length; i++) {
          tabContents[i].classList.remove("active");
        }
        
        // 移除所有頁籤按鈕的active類別
        var tabButtons = document.getElementsByClassName("tab-button");
        for (var i = 0; i < tabButtons.length; i++) {
          tabButtons[i].classList.remove("active");
        }
        
        // 顯示當前頁籤內容並添加active類別給當前按鈕
        document.getElementById(tabId).classList.add("active");
        evt.currentTarget.classList.add("active");
      }

      // 側邊選單功能
      document.getElementById('menu-toggle').addEventListener('click', function() {
        document.getElementById('side-menu').classList.add('active');
        document.getElementById('overlay').classList.add('active');
        document.body.classList.add('no-scroll');
      });

      document.getElementById('menu-close').addEventListener('click', closeMenu);
      document.getElementById('overlay').addEventListener('click', closeMenu);

      function closeMenu() {
        document.getElementById('side-menu').classList.remove('active');
        document.getElementById('overlay').classList.remove('active');
        document.body.classList.remove('no-scroll');
      }

      // 回到頂部按鈕功能
      const backToTopButton = document.getElementById('back-to-top');
      
      window.addEventListener('scroll', () => {
        if (window.scrollY > 300) {
          backToTopButton.classList.add('show');
        } else {
          backToTopButton.classList.remove('show');
        }
      });
      
      backToTopButton.addEventListener('click', () => {
        window.scrollTo({
          top: 0,
          behavior: 'smooth'
        });
      });
      
      // 搜尋功能
      const searchInput = document.getElementById('search-input');
      const clearSearch = document.getElementById('clear-search');
      
      searchInput.addEventListener('input', performSearch);
      clearSearch.addEventListener('click', clearSearchField);
      
      function performSearch() {
        const searchTerm = searchInput.value.toLowerCase();
        const timelineItems = document.querySelectorAll('.timeline-item');
        const tabContents = document.querySelectorAll('.tab-content');
        const tabs = document.querySelectorAll('.tab-button');
        
        // 如果搜尋框為空，顯示所有內容並返回預設頁籤
        if (searchTerm === '') {
          timelineItems.forEach(item => {
            item.style.display = '';
            item.classList.remove('highlight');
          });
          
          // 顯示當前激活頁籤
          tabContents.forEach(tab => {
            if (tab.classList.contains('active')) {
              tab.style.display = 'block';
            } else {
              tab.style.display = 'none';
            }
          });
          
          return;
        }
        
        // 顯示所有頁籤內容以便搜尋
        tabContents.forEach(tab => {
          tab.style.display = 'block';
        });
        
        // 取消所有頁籤的激活狀態
        tabs.forEach(tab => {
          tab.classList.remove('active');
        });
        
        let hasResults = false;
        
        // 搜尋事件
        timelineItems.forEach(item => {
          const dateText = item.querySelector('.timeline-date').textContent.toLowerCase();
          const eventText = item.querySelector('.timeline-event').textContent.toLowerCase();
          
          if (dateText.includes(searchTerm) || eventText.includes(searchTerm)) {
            item.style.display = '';
            item.classList.add('highlight');
            hasResults = true;
            
            // 找到該項目所在的頁籤並顯示
            const parentTab = item.closest('.tab-content');
            if (parentTab) {
              const tabId = parentTab.id;
              document.querySelector(`button[onclick*="${tabId}"]`).classList.add('active');
            }
          } else {
            item.style.display = 'none';
            item.classList.remove('highlight');
          }
        });
        
        // 如果沒有結果，顯示提示訊息
        if (!hasResults) {
          // 可以添加一個沒有結果的訊息元素
          console.log('沒有符合的結果');
        }
      }
      
      function clearSearchField() {
        searchInput.value = '';
        performSearch();
      }

      // 倒數計時功能
      function updateCountdowns() {
        // 處理舊版倒數計時
        const oldCountdownTimers = document.querySelectorAll('.countdown-timer');
        
        oldCountdownTimers.forEach(timer => {
          const targetDateStr = timer.getAttribute('data-date');
          const targetTimeStr = timer.getAttribute('data-time') || '00:00';
          const targetDate = parseROCDate(targetDateStr, targetTimeStr);
          
          // 計算剩餘時間
          const now = new Date();
          const diff = targetDate - now;
          
          // 如果日期已過，顯示已過期
          if (diff < 0) {
            timer.textContent = '已過期';
            timer.classList.add('expired');
            return;
          }
          
          // 計算天數、小時、分鐘、秒數
          const days = Math.floor(diff / (1000 * 60 * 60 * 24));
          const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
          const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
          const seconds = Math.floor((diff % (1000 * 60)) / 1000);
          
          // 更新顯示，為數字加上 span 元素和標籤
          timer.innerHTML = `
            <div class="countdown-unit"><span>${days}</span><small>天</small></div>
            <div class="countdown-unit"><span>${hours}</span><small>時</small></div>
            <div class="countdown-unit"><span>${minutes}</span><small>分</small></div>
            <div class="countdown-unit"><span>${seconds}</span><small>秒</small></div>
          `;
        });
        
        // 處理新版倒數計時
        const newCountdownTimers = document.querySelectorAll('.countdown-timer-new');
        
        newCountdownTimers.forEach(timer => {
          const targetDateStr = timer.getAttribute('data-date');
          const targetTimeStr = timer.getAttribute('data-time') || '00:00';
          const targetDate = parseROCDate(targetDateStr, targetTimeStr);
          
          // 找到父元素 (countdown-box)
          const countdownBox = timer.closest('.countdown-box');
          
          // 計算剩餘時間
          const now = new Date();
          const diff = targetDate - now;
          
          // 計算開始日期（假設事件提前3個月開始倒數）
          const startDate = new Date(targetDate);
          startDate.setMonth(startDate.getMonth() - 3);
          
          // 計算總時間範圍和已經過去的時間
          const totalTimeRange = targetDate - startDate;
          const elapsedTime = now - startDate;
          
          // 計算進度百分比
          let progressPercent = (elapsedTime / totalTimeRange) * 100;
          progressPercent = Math.max(0, Math.min(100, progressPercent)); // 限制在0-100之間
          
          // 更新進度條
          const progressFill = countdownBox.querySelector('.progress-fill');
          if (progressFill) {
            progressFill.style.width = `${progressPercent}%`;
          }
          
          // 如果日期已過，顯示已過期
          if (diff < 0) {
            timer.querySelectorAll('.time-value').forEach(value => {
              value.textContent = '00';
            });
            
            countdownBox.classList.add('expired');
            return;
          }
          
          // 如果在7天內，添加即將到來的類別
          if (diff < 7 * 24 * 60 * 60 * 1000) {
            countdownBox.classList.add('coming-soon');
          } else {
            countdownBox.classList.remove('coming-soon');
          }
          
          // 計算天數、小時、分鐘、秒數
          const days = Math.floor(diff / (1000 * 60 * 60 * 24));
          const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
          const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
          const seconds = Math.floor((diff % (1000 * 60)) / 1000);
          
          // 更新顯示
          const daysElement = timer.querySelector('.days');
          const hoursElement = timer.querySelector('.hours');
          const minutesElement = timer.querySelector('.minutes');
          const secondsElement = timer.querySelector('.seconds');
          
          if (daysElement) daysElement.textContent = days.toString().padStart(2, '0');
          if (hoursElement) hoursElement.textContent = hours.toString().padStart(2, '0');
          if (minutesElement) minutesElement.textContent = minutes.toString().padStart(2, '0');
          if (secondsElement) secondsElement.textContent = seconds.toString().padStart(2, '0');
        });
      }
      
      // 解析中華民國日期和時間格式 (例如 113/12/16 14:00)
      function parseROCDate(dateStr, timeStr = '00:00') {
        // 處理類似 113/12/16-20 的日期範圍，僅取開始日期
        if (dateStr.includes('-')) {
          dateStr = dateStr.split('-')[0];
        }
        
        // 分解日期部分
        const parts = dateStr.split('/');
        if (parts.length >= 3) {
          // 轉換民國年為西元年
          const year = parseInt(parts[0]) + 1911;
          const month = parseInt(parts[1]) - 1; // JavaScript月份從0開始
          const day = parseInt(parts[2]);
          
          // 分解時間部分
          const timeParts = timeStr.split(':');
          const hour = parseInt(timeParts[0]) || 0;
          const minute = parseInt(timeParts[1]) || 0;
          
          return new Date(year, month, day, hour, minute, 0);
        }
        
        // 預設返回當前日期
        return new Date();
      }
      
      // 初始化並每秒更新倒數計時
      updateCountdowns();
      setInterval(updateCountdowns, 1000);

      // 分享功能
      function shareOnFacebook() {
        const url = encodeURIComponent(window.location.href);
        const title = encodeURIComponent(document.title);
        window.open(`https://www.facebook.com/sharer/sharer.php?u=${url}&t=${title}`, '_blank');
      }
      
      function shareOnLine() {
        const url = encodeURIComponent(window.location.href);
        const title = encodeURIComponent(document.title);
        window.open(`https://social-plugins.line.me/lineit/share?url=${url}&text=${title}`, '_blank');
      }
      
      function shareByEmail() {
        const subject = encodeURIComponent(document.title);
        const body = encodeURIComponent(`我想與你分享這個有用的資訊：\n${window.location.href}`);
        window.open(`mailto:?subject=${subject}&body=${body}`);
      }
      
      function copyShareLink() {
        navigator.clipboard.writeText(window.location.href).then(() => {
          const copyMessage = document.getElementById('copy-message');
          copyMessage.classList.add('show');
          setTimeout(() => {
            copyMessage.classList.remove('show');
          }, 2000);
        });
      }
    </script>
    <script src="calendar-export.js"></script>
  </body>
</html> 